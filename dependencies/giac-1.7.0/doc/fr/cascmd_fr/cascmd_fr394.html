<!DOCTYPE html>
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.29+5 of 2017-05-18">
<link rel="stylesheet" type="text/css" href="cascmd_fr.css">
<title>Interpolation de Lagrange : lagrange interp</title>
</head>
<body >
<a href="cascmd_fr393.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_fr395.html"><img src="next_motif.gif" alt="Next"></a>
<hr>
<h3 id="sec505" class="subsection">6.28.33  Interpolation de Lagrange : <span style="font-family:monospace">lagrange interp</span></h3>
<p><a id="hevea_default751"></a><a id="hevea_default752"></a><a id="hevea_default753"></a> <a id="sec:diffdiv"></a>
Selon le dernier paramètre on a :
</p><ol class="enumerate" type=1><li class="li-enumerate">
<span style="font-family:monospace">lagrange</span> permet d’interpoler une fonction <span style="font-style:italic">f</span> aux points 
d’abscisses <span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub> (<span style="font-style:italic">k</span>=0..<span style="font-style:italic">n</span>−1) par un polynôme de degré <span style="font-style:italic">n</span>−1 : c’est le 
polynôme d’interpolation de Lagrange.<br>
<span style="font-family:monospace">lagrange</span> renvoie ce polynôme soit sous forme symbolique, soit selon la 
liste de ses coefficients (le dernier paramètre doit être alors le nom de 
la variable choisie ou <span style="font-family:monospace">[]</span>).
</li><li class="li-enumerate"><span style="font-family:monospace">lagrange</span> effectue aussi le calcul des différences divisées du 
polynôme de Lagrange (le dernier paramètre est alors <span style="font-style:oblique">lagrange</span>).
</li></ol><ol class="enumerate" type=1><li class="li-enumerate">
Polynôme d’interpolation de Lagrange<br>
<span style="font-family:monospace">lagrange</span> a 1, 2 ou 3 arguments :
<ul class="itemize"><li class="li-itemize">
deux listes de longueur <span style="font-family:monospace">n</span> (ou une matrice de deux lignes et <span style="font-family:monospace">n</span>
colonnes) et eventuellement le nom de la variable <span style="font-family:monospace">var</span> (par défaut 
<span style="font-family:monospace">x</span>) pour que le polynôme soit sous forme symbolique ou eventuellement 
une liste vide (<span style="font-family:monospace">[]</span>) pour que le polynôme soit selon la liste de ses 
coefficients.<br>
La première liste (ou ligne) correspond à des valeurs d’abscisses <span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>, et 
La deuxième liste (ou ligne) correspond à des valeurs d’ordonnées <span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub> 
pour <span style="font-style:italic">k</span> allant de 0 à <span style="font-family:monospace">n-1</span>,
</li><li class="li-itemize">une liste de longueur <span style="font-family:monospace">n</span> correspondant aux valeurs d’abscisses <span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub> 
et une fonction <span style="font-style:italic">f</span> et eventuellement <span style="font-family:monospace">[]</span> ou le nom de la variable 
<span style="font-family:monospace">var</span> (par défaut <span style="font-family:monospace">x</span>).<br>
 Les valeurs des ordonnées sont alors <span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>=<span style="font-style:italic">f</span>(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>) pour <span style="font-style:italic">k</span>=0..<span style="font-style:italic">n</span>−1.<br>
<span style="font-family:monospace">lagrange</span> renvoie une expression polynômiale <span style="font-family:monospace">P(var)</span> de degré 
<span style="font-family:monospace">n-1</span> tel que <span style="font-style:italic">P</span>(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>)=<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub> (<span style="font-style:italic">k</span>=0..<span style="font-style:italic">n</span>−1) ou la liste des coefficients de
<span style="font-family:monospace">P</span> (selon les puissances décroissantes) c’est à dire l’écriture 
liste du polynôme de degré <span style="font-family:monospace">n-1</span> tel que <span style="font-style:italic">P</span>(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>)=<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub> (<span style="font-style:italic">k</span>=0..<span style="font-style:italic">n</span>−1).<br>
</li></ul>
</li><li class="li-enumerate">Différences divisées du polynôme de Lagrange<br>
<span style="font-family:monospace">lagrange</span> a comme argument deux listes de longueur <span style="font-family:monospace">n</span> (ou une matrice
de deux lignes et <span style="font-family:monospace">n</span> colonnes) et comme dernier argument l’option 
<span style="font-style:oblique">lagrange</span> de la commande <span style="font-family:monospace">lagrange</span>.<br>
<span style="font-family:monospace">lagrange</span> renvoie la liste des différences divisées :<br>
[α<sub>0</sub>...α<sub><span style="font-style:italic">n</span>−1</sub>].<br>
<span style="font-weight:bold">Définition de </span>α<sub>0</sub>,..,α<sub><span style="font-style:italic">n</span>−1</sub><br>
Si <span style="font-style:italic">P</span>(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>)=<span style="font-style:italic">y</span><sub><span style="font-style:italic">k</span></sub>=<span style="font-style:italic">f</span>(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>) (<span style="font-style:italic">k</span>=0..<span style="font-style:italic">n</span>−1) i.e. si <span style="font-style:italic">P</span> interpole <span style="font-style:italic">f</span> en 
[<span style="font-style:italic">x</span><sub>0</sub>,..,<span style="font-style:italic">x</span><sub><span style="font-style:italic">n</span>−1</sub>], on a :<br>
<span style="font-style:italic">P</span>(<span style="font-style:italic">x</span>)=α<sub>0</sub>+α<sub>1</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)+...+α<sub><span style="font-style:italic">n</span>−1</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>1</sub>)...(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub><span style="font-style:italic">n</span>−2</sub>)<br>
On a alors :<br>
α<sub>0</sub>=<span style="font-style:italic">P</span>(<span style="font-style:italic">x</span><sub>0</sub>)=<span style="font-style:italic">f</span>(<span style="font-style:italic">x</span><sub>0</sub>)<br>
 α<sub>1</sub>=<span style="font-style:italic">f</span>(<span style="font-style:italic">x</span><sub>1</sub>)−<span style="font-style:italic">f</span>(<span style="font-style:italic">x</span><sub>0</sub>)/<span style="font-style:italic">x</span><sub>1</sub>−<span style="font-style:italic">x</span><sub>0</sub>=<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>0</sub>,<span style="font-style:italic">x</span><sub>1</sub>]<br>
 <span style="font-style:italic">P</span>(<span style="font-style:italic">x</span><sub>2</sub>)=α<sub>0</sub>+α<sub>1</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)+α<sub>2</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>1</sub>)<br>
donc <br>
 α<sub>2</sub>=<span style="font-style:italic">P</span>(<span style="font-style:italic">x</span><sub>2</sub>)−α<sub>0</sub>/(<span style="font-style:italic">x</span><sub>2</sub>−<span style="font-style:italic">x</span><sub>0</sub>)(<span style="font-style:italic">x</span><sub>2</sub>−<span style="font-style:italic">x</span><sub>1</sub>)−α<sub>1</sub>/<span style="font-style:italic">x</span><sub>2</sub>−<span style="font-style:italic">x</span><sub>1</sub><br>
 <span style="font-style:italic">P</span>(<span style="font-style:italic">x</span><sub>3</sub>)=α<sub>0</sub>+α<sub>1</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)+α<sub>2</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>1</sub>)+α<sub>(</sub><span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>1</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>2</sub>)<br>
donc <br>
 α<sub>3</sub>=<span style="font-style:italic">P</span>(<span style="font-style:italic">x</span><sub>3</sub>)−α<sub>0</sub>−α<sub>1</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)−α<sub>2</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>1</sub>/(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>1</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>2</sub>)=<br>
 <span style="font-style:italic">P</span>(<span style="font-style:italic">x</span><sub>3</sub>)−α<sub>0</sub>/(<span style="font-style:italic">x</span><sub>3</sub>−<span style="font-style:italic">x</span><sub>0</sub>)(<span style="font-style:italic">x</span><sub>3</sub>−<span style="font-style:italic">x</span><sub>1</sub>)(<span style="font-style:italic">x</span><sub>3</sub>−<span style="font-style:italic">x</span><sub>2</sub>)−α<sub>1</sub>/(<span style="font-style:italic">x</span><sub>3</sub>−<span style="font-style:italic">x</span><sub>1</sub>)(<span style="font-style:italic">x</span><sub>3</sub>−<span style="font-style:italic">x</span><sub>2</sub>)−α<sub>2</sub>/<span style="font-style:italic">x</span><sub>3</sub>−<span style="font-style:italic">x</span><sub>2</sub><br>
<span style="font-weight:bold">Notations</span><br>
On note :<br>
<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>0</sub>,<span style="font-style:italic">x</span><sub>1</sub>]=α<sub>1</sub>= <span style="font-style:italic">f</span>(<span style="font-style:italic">x</span><sub>1</sub>)−<span style="font-style:italic">f</span>(<span style="font-style:italic">x</span><sub>0</sub>)/<span style="font-style:italic">x</span><sub>1</sub>−<span style="font-style:italic">x</span><sub>0</sub><br>
α<sub><span style="font-style:italic">k</span></sub>=<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>0</sub>,..,<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>]<br>
Le calcul des α<sub><span style="font-style:italic">k</span></sub> se fait par récurrence.<br>
Si <span style="font-style:italic">P</span><sub><span style="font-style:italic">k</span></sub> est le polynôme de lagrange qui interpole <span style="font-style:italic">f</span> en [<span style="font-style:italic">x</span><sub>0</sub>,..,<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>], 
on a: <br>
<span style="font-style:italic">P</span><sub><span style="font-style:italic">k</span></sub>(<span style="font-style:italic">x</span>)=α<sub>0</sub>+α<sub>1</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)+...+α<sub><span style="font-style:italic">k</span></sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>1</sub>)...(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span>−1</sub>)<br>
Si <span style="font-style:italic">Q</span><sub><span style="font-style:italic">k</span></sub> est le polynôme de lagrange qui interpole <span style="font-style:italic">f</span> en [<span style="font-style:italic">x</span><sub>1</sub>,..,<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span>+1</sub>], 
on a :<br>
<span style="font-style:italic">Q</span><sub><span style="font-style:italic">k</span></sub>(<span style="font-style:italic">x</span>)=β<sub>0</sub>+β<sub>1</sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>1</sub>)+...+β<sub><span style="font-style:italic">k</span></sub>(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>1</sub>)(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>2</sub>)...(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span></sub>)<br>
β<sub>0</sub>=<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>1</sub>], β<sub>1</sub>=<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>1</sub>,<span style="font-style:italic">x</span><sub>2</sub>], β<sub><span style="font-style:italic">k</span></sub>=<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>1</sub>,..,<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span>+1</sub>].<br>
<span style="font-weight:bold">Propriétés</span><br>
On a :<br>
 <span style="font-style:italic">P</span><sub><span style="font-style:italic">k</span>+1</sub>(<span style="font-style:italic">x</span>)=(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span>+1</sub>−<span style="font-style:italic">x</span>)<span style="font-style:italic">P</span><sub><span style="font-style:italic">k</span></sub>(<span style="font-style:italic">x</span>)+(<span style="font-style:italic">x</span>−<span style="font-style:italic">x</span><sub>0</sub>)<span style="font-style:italic">Q</span><sub><span style="font-style:italic">k</span></sub>(<span style="font-style:italic">x</span>)/<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span>+1</sub>−<span style="font-style:italic">x</span><sub>0</sub><br>
et<br>
α<sub><span style="font-style:italic">k</span>+1</sub> est le <span style="font-family:monospace">lcoeff</span> de <span style="font-style:italic">P</span><sub><span style="font-style:italic">k</span>+1</sub> (<span style="font-family:monospace">lcoeff(P)</span> est le 
coefficient du terme de plus haut degré (dominant=leading)) donc<br>
α<sub><span style="font-style:italic">k</span>+1</sub>=(<span style="font-family:monospace">lcoeff</span>(<span style="font-style:italic">Q</span><sub><span style="font-style:italic">k</span></sub>)-<span style="font-family:monospace">lcoeff</span>(<span style="font-style:italic">P</span><sub><span style="font-style:italic">k</span></sub>))/(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span>+1</sub>−<span style="font-style:italic">x</span><sub>0</sub>)<br>
α<sub><span style="font-style:italic">k</span>+1</sub>=(β<sub><span style="font-style:italic">k</span></sub>−α<sub><span style="font-style:italic">k</span></sub>)/(<span style="font-style:italic">x</span><sub><span style="font-style:italic">k</span>+1</sub>−<span style="font-style:italic">x</span><sub>0</sub>)
ce qui donne l’algorithme calculant les différences divisées.
</li></ol><p>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([[1,3],[0,1]])</span></div><p>
Ou on tape :
</p><div class="center"><span style="font-family:monospace">lagrange([1,3],[0,1])</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">(x-1)/2</span></div><p>
en effet pour <span style="font-style:italic">x</span>=1 on a <span style="font-style:italic">x</span>−1/2=0  et pour <span style="font-style:italic">x</span>=3 on a 
<span style="font-style:italic">x</span>−1/2=1.<br>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([1,3],[0,1],y)</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">(y-1)/2</span></div><p>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([1,3],[0,1],[])</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">[1/2,-1/2]</span></div><p>
qui est l’écriture liste du polynôme <span style="font-family:monospace">x/2-1/2</span><br>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([1,3],[0,1],lagrange)</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">[0,1/2]</span></div><p>
en effet :
<span style="font-style:italic">P</span>(<span style="font-style:italic">x</span>)=(<span style="font-style:italic">x</span>−1)/2=0+1/2(<span style="font-style:italic">x</span>−1)<br>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([1,2,3,4],[15,24,33,54],x)</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">(2*(x-3)*(x-2)+9)*(x-1)+15</span></div><p>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([1,2,3,4],[15,24,33,54],[])</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">[2,-12,31,-6]</span></div><p>
qui est la liste <span style="font-style:italic">a</span><sub>3</sub>,<span style="font-style:italic">a</span><sub>2</sub>,<span style="font-style:italic">a</span><sub>1</sub>,<span style="font-style:italic">a</span><sub>0</sub> des coefficients <span style="font-style:italic">a</span><sub><span style="font-style:italic">k</span></sub> de <span style="font-style:italic">x</span><sup><span style="font-style:italic">k</span></sup> du polynôme 
<span style="font-family:monospace">(2*(x-3)*(x-2)+9)*(x-1)+15=2*x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">3-12*x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2+31*x-6</span><br>
On tape (lorsque l’écriture des polynômes est selon les puissances 
décroissantes) :
</p><div class="center"><span style="font-family:monospace">normal((2*(x-3)*(x-2)+9)*(x-1)+15)</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">2*x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">3-12*x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2+31*x-6</span></div><p>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([1,2,3,4],[15,24,33,54],lagrange)</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">[15,9,0,2]</span></div><p>
en effet, on a <span style="font-style:italic">P</span>(<span style="font-style:italic">x</span>)=2*<span style="font-style:italic">x</span><sup>3</sup>−12*<span style="font-style:italic">x</span><sup>2</sup>+31*<span style="font-style:italic">x</span>−6 donc :<br>
<span style="font-style:italic">P</span>(1)=15, (<span style="font-style:italic">P</span>(2)−<span style="font-style:italic">P</span>(1))/(2−1)=9, (<span style="font-style:italic">P</span>(3)−15)/2−9=(33−15)/2−9=0<br>
(<span style="font-style:italic">P</span>(4)−15)/((4−1)*(3−1)*(2−1))−9/((3−1)*(2−1))=(54−15)/6−9/2=2<br>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([0,1,2],[1,2,-1])</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">1+3*x-2*x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2</span></div><p>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([0,1,2],[1,2,-1],y)</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">(-2*(y-1)+1)*y+1</span></div><p>
soit après simplification :
</p><div class="center"><span style="font-family:monospace">(1+3*y-2*y</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2</span></div><p>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([0,1,2],[1,2,-1],[])</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">[-2,3,1]</span></div><p>
qui est l’écriture liste du polynôme <span style="font-family:monospace">-2*x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2+3x+1</span><br>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([0,1,2],[1,2,-1],lagrange)</span></div><p>
On obtient :
</p><div class="center"><span style="font-family:monospace">[1,1,-2]</span></div><p>
en effet : <span style="font-style:italic">P</span>(0)=1, <span style="font-style:italic">P</span>(1)=2, <span style="font-style:italic">P</span>(2)=−1 et <br>
<span style="font-style:italic">P</span>(<span style="font-style:italic">x</span>)=1+1*(<span style="font-style:italic">x</span>−0)−2*(<span style="font-style:italic">x</span>−0)*(<span style="font-style:italic">x</span>−1)=−2<span style="font-style:italic">x</span><sup>2</sup>+3<span style="font-style:italic">x</span>+1<br>
<span style="font-style:italic">P</span>(<span style="font-style:italic">x</span>)=1+<span style="font-style:italic">x</span>(1+(<span style="font-style:italic">x</span>−1)*(−2))=1+<span style="font-style:italic">x</span>−2<span style="font-style:italic">x</span>(<span style="font-style:italic">x</span>−1)=−2<span style="font-style:italic">x</span><sup>2</sup>+3<span style="font-style:italic">x</span>+1<br>
On tape :
</p><div class="center"><span style="font-family:monospace">f(x):=exp(x)-1</span></div><div class="center"><span style="font-family:monospace">lagrange([-1,0,1],[f(-1),f(0),f(1)])</span></div><p>
ou
</p><div class="center"><span style="font-family:monospace">lagrange([-1,0,1],[1/e-1,0,e-1])</span></div><p>
ou
</p><div class="center"><span style="font-family:monospace">lagrange([-1,0,1],f)</span></div><p>
On obtient après simplification et linéarisation du numérateur :
</p><div class="center"><span style="font-family:monospace">(-x+x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2+(x+x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2)*exp(2)-2*x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2*exp(1))/(2*exp(1))</span></div><p>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([0,1,2],[1,exp(1),exp(2)],[])</span></div><p>
On obtient :<br>
</p><div class="center"><span style="font-family:monospace">[(1-2*exp(1)+exp(1)</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2)/2,(-3+4*exp(1)-exp(1)</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2)/2,1]</span></div><p>
On tape :
</p><div class="center"><span style="font-family:monospace">lagrange([0,1,2],[1,exp(1),exp(2)],lagrange)</span></div><p>
ou 
</p><div class="center"><span style="font-family:monospace">lagrange([0,1,2],exp,lagrange)</span></div><p>
On obtient :<br>
</p><div class="center"><span style="font-family:monospace">[1,exp(1)-1,(exp(1)-1)</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2/2]</span></div><p>
On a en effet :<br>
<span style="font-style:italic">P</span>(<span style="font-style:italic">x</span>)=1+<span style="font-style:italic">x</span>((<span style="font-style:italic">exp</span>(1)−1)+(<span style="font-style:italic">x</span>−1)(<span style="font-style:italic">exp</span>(1)−1)<sup>2</sup>/2)<br>
On a bien <span style="font-style:italic">P</span>(0)=1, <span style="font-style:italic">P</span>(1)=<span style="font-style:italic">e</span>−1, <span style="font-style:italic">P</span>(2)=1+2(<span style="font-style:italic">e</span>−1+<span style="font-style:italic">e</span><sup>2</sup>/2−<span style="font-style:italic">e</span>+1/2)=1−2+1+<span style="font-style:italic">e</span><sup>2</sup>=<span style="font-style:italic">e</span><sup>2</sup><br>
Si on applique l’algorithme :<br>
<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>0</sub>]=α<sub>0</sub>=1, <span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>1</sub>]=β<sub>0</sub>=<span style="font-style:italic">e</span>, <span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>2</sub>]=γ<sub>0</sub>=<span style="font-style:italic">e</span><sup>2</sup>,<br>
<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>0</sub><span style="font-style:italic">x</span><sub>1</sub>]=α<sub>1</sub>=(β<sub>0</sub>−α<sub>0</sub>)/(1−0)=<span style="font-style:italic">e</span>−1,<br>
<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>1</sub><span style="font-style:italic">x</span><sub>2</sub>]=β<sub>1</sub>=(γ<sub>0</sub>−β<sub>0</sub>)/(1−0)=<span style="font-style:italic">e</span><sup>2</sup>−<span style="font-style:italic">e</span>,<br>
<span style="font-style:italic">f</span>[<span style="font-style:italic">x</span><sub>1</sub><span style="font-style:italic">x</span><sub>2</sub><span style="font-style:italic">x</span><sub>3</sub>]=α<sub>2</sub>=(β<sub>1</sub>−α<sub>1</sub>)/(2−0)=(<span style="font-style:italic">e</span><sup>2</sup>−2<span style="font-style:italic">e</span>+1)/2<br>
<span style="font-weight:bold">Attention</span><br>
<span style="font-family:monospace">lagrange([1,2],[3,4],y)</span> ne renvoie pas une fonction mais une expression.
mais on peut définir une fonction en mettant :<br>
<span style="font-family:monospace">f(x):=lagrange([1,2],[3,4],x)</span> ou<br>
<span style="font-family:monospace">f(y):=lagrange([1,2],[3,4],y)</span> et alors <br>
<span style="font-family:monospace">f(4)</span> renvoie <span style="font-family:monospace">6</span> car <span style="font-family:monospace">f(x)=x+2</span>)<br>
Bien voir la différence entre :<br>
<span style="font-family:monospace">g(x):=lagrange([1,2],[3,4])</span> et<br>
<span style="font-family:monospace">f(x):=lagrange([1,2],[3,4],x)</span>.<br>
<span style="font-family:monospace">g(x):=lagrange([1,2],[3,4])</span> ne definit pas une fonction,
par exemple, <span style="font-family:monospace">g(2)=x-1+3</span> alors que <span style="font-family:monospace">f(2)=4</span>.<br>
Ceci dit, la définition of <span style="font-family:monospace">f</span> n’est pas efficace car le polynôme sera 
recalculé depuis le
début à chaque appel de <span style="font-family:monospace">f</span> (quand on définit une fonction le membre 
de droite n’est pas évalué, l’évaluation est faite seulement quand on 
appelle <span style="font-family:monospace">f</span>).<br>
Pour être efficace il faut utiliser <span style="font-family:monospace">unapply</span>:<br>
<span style="font-family:monospace">f:=unapply(lagrange([1,2],[3,4]),x)</span> ou<br>
<span style="font-family:monospace">f:=unapply(lagrange([1,2],[3,4],y),y)</span>.<br>
<span style="font-weight:bold">Exercice</span>
Soient <span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>) = 1/<span style="font-style:italic">x</span>, <span style="font-style:italic">x</span><sub>0</sub>=2 <span style="font-style:italic">x</span><sub>1</sub> = 2.5 et <span style="font-style:italic">x</span><sub>2</sub> =4.
On demande de calculer le polynôme <span style="font-style:italic">L</span> d’interpolation de Lagrange et sa 
valeur en <span style="font-style:italic">x</span>=3 et <span style="font-style:italic">x</span>=4.5.<br>
On tape :<br>
<span style="font-family:monospace">f(x):=1/x</span><br>
<span style="font-family:monospace">L:=unapply(normal(lagrange([2,2.5,4],[f(2),f(2.5),f(4)])),x)</span><br>
On obtient :<br>
<span style="font-family:monospace">x-&gt;0.05*x</span><code><span style="font-family:monospace">^</span></code><span style="font-family:monospace">2-0.425*x+1.15</span><br>
On tape :<br>
<span style="font-family:monospace">L(3),L(4.5)</span><br>
On obtient :<br>
<span style="font-family:monospace">0.325,0.25</span>
</p>
<hr>
<a href="cascmd_fr393.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="cascmd_fr395.html"><img src="next_motif.gif" alt="Next"></a>
</body>
</html>
