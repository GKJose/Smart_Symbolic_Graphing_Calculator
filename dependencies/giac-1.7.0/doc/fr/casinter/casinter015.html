<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
            "http://www.w3.org/TR/REC-html40/loose.dtd">
<HTML>
<HEAD>

<META http-equiv="Content-Type" content="text/html; charset=UTF-8">
<META name="GENERATOR" content="hevea 1.10">
<LINK rel="stylesheet" type="text/css" href="casinter.css">
<TITLE>Les graphiques</TITLE>
</HEAD>
<BODY >
<A HREF="casinter014.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A>
<A HREF="index.html"><IMG SRC="contents_motif.gif" ALT="Up"></A>
<A HREF="casinter016.html"><IMG SRC="next_motif.gif" ALT="Next"></A>
<HR>
Retour &#XE0; la page personnelle de <A HREF="http://www-fourier.ujf-grenoble.fr/parisse">Bernard Parisse</A>.<H2 CLASS="section"><A NAME="htoc45">12</A>  Les graphiques</H2><P>
Il y a plusieurs types de graphiques: dans le plan (2-d), dans
l’espace (3-d), qui peuvent faire partie ou non d’une figure
géométrique. Pour créer les types de graphes les plus courants,
vous pouvez utiliser les assistants du menu <TT>Graphes</TT> qui
se chargera de créer un niveau avec une ligne de commande, de le
remplir et de le valider.
Ainsi une commande pour tracer un graphe de fonction :<BR>
<CODE>plotfunc(sin(x),x=-5..5)</CODE> affichera un graphe 2-d (qui ne fait
pas partie d’une figure),<BR>
<CODE>plotfunc(x^2-y^2,[x=-3..3,y=-4..4])</CODE>
affichera un graphe 3-d (qui ne fait pas partie d’une figure).<BR>
Alors que le menu <CODE>Geo-&gt;Nouvelle figure</CODE> 
permet d’ajouter un écran de 
géométrie 2-d ou 3-d permettant de faire à la fois une figure 
géométrique et des tracés de fonctions.</P><P>Chaque graphique dispose à sa droite de boutons permettant de changer
la visualisation du graphique : déplacement selon les axes, zoom in et
out, arrêt ou reprise d’une animation, configuration, ou
d’exporter/imprimer le graphique. Les deux sous-sections qui suivent
décrivent les réglages spécifiques au graphes dans le plan et dans
l’espace, les deux sections qui suivent expliquent comment créer
des figures dans le plan ou dans l’espace. Les sections décrivant les
attributs des objets des figures 2-d et 3-d (<A HREF="casinter016.html#sec:attributs2d">13.6</A>
et <A HREF="casinter017.html#sec:attributs3d">14.3.2</A>) peuvent être appliquées
à la plupart des commandes de tracés même si elles ne font pas partie d’une
figure, par exemple on peut saisir dans un niveau de calcul formel :
</P><DIV CLASS="center">
<TT>plotfunc(cos(x)+cos(y)+cos(x+y),[x=-2*pi..2*pi, y=-2*pi..2*pi],
xstep=0.2,ystep=0.2, affichage=vert+rempli);<BR>
plan(z=1,affichage=cyan+rempli)</TT>
</DIV><H3 CLASS="subsection"><A NAME="toc32"></A><A NAME="htoc46">12.1</A>  Animations</H3><P>
Les instructions <CODE>animate</CODE>, <CODE>animate3d</CODE>
ou <CODE>animation</CODE> permettent de créer des animations en
faisant défiler à l’écran une suite de graphe. Le bouton
à gauche du <CODE>M</CODE> permet d’arrêter ou reprendre une animation
(raccourci clavier: <TT>p</TT> pour pause). Pour afficher une image en avant
on utilise le raccourci clavier <TT>n</TT> ou on clique dans le graphe en 3-d. 
Pour revenir d’une image en arrière, on utilise
la touche <TT>b</TT>. On peut configurer le temps entre 2 images en cliquant
sur le bouton <CODE>cfg</CODE> (et remplir la case <CODE>animate</CODE>).<BR>
Le bouton <CODE>M</CODE> permet aussi de créer une animation automatiquement pour
des graphes qui dependent d’un paramètre : dans ce cas il faut choisir :<BR>
<CODE>M-Enlever le graphe</CODE> puis <CODE>M-Creer animation</CODE> pour que le graphe
initial ne se superpose pas avec l’animation. Pour créer l’animation (on vous
demande combien vous voulez d’images (<TT>frame</TT>) différentes), le temps 
entre 2 images est toujours définie dans <TT>cfg-&gt;animate</TT>.<BR>
Il ne faut pas confondre ces animations programmées avec les
animations de rotation des graphes 3-d (cf. la section <A HREF="#sec:anim3d">12.3.4</A>).</P><H3 CLASS="subsection"><A NAME="toc33"></A><A NAME="htoc47">12.2</A>  Graphes dans le plan</H3><P>
On peut effectuer un zoom sur une zone rectangulaire d’un graphe
n’appartenant pas à une figure en sélectionnant le rectangle
avec le bouton droit de la souris.</P><P>Lorsqu’un niveau graphique a le focus, la molette de la souris permet 
de faire un zoom avant ou arrière.</P><H3 CLASS="subsection"><A NAME="toc34"></A><A NAME="htoc48">12.3</A>  Graphes dans l’espace</H3><P>
Pour les graphes dans l’espace, on peut choisir entre une
représentation en perspective ou en projection orthogonale (dont on 
peut modifier le point de vue) et entre
une visualisation en couleurs intrinsèques ou par éclairage
par 1 à 8 spots lumineux dont on peut controler la position et
les propriétés.<BR>
On peut choisir d’avoir les axes avec le tri‘edre et le plan de la souris en 
cochant <TT>Montrer les axes</TT> ou d’avoir justr le trièdre en décochant 
<TT>Montrer les axes</TT> et en cochant <TT>Triedre</TT> ou de ne rien avoie en 
décochant <TT>Montrer les axes</TT> et <TT>Triedre</TT>.
</P><H4 CLASS="subsubsection"><A NAME="htoc49">12.3.1</A>  Comment modifier le point de vue</H4><P><A NAME="@default22"></A>
Pour les graphes dans l’espace, on peut changer le point de vue en
appuyant sur la souris en-dehors du parallélépipède de visualisation
et en déplaçant la souris, ou avec les touches x,X, y,Y, z,Z pour
faire tourner le point de vue autour de l’axe des x, y ou z. </P><H4 CLASS="subsubsection"><A NAME="htoc50">12.3.2</A>  Le plan de vision et l’axe de vision</H4><P><A NAME="@default23"></A>
<A NAME="@default24"></A>
L’axe de vision est une droite passant par l’observateur et de vecteur 
directeur la direction de la visée de l’objet : tous les points situés sur 
une parallèle à l’axe de vision seront représentés par un seul point.</P><P>Le plan de vision est un plan perpendiculaire à l’axe de vision et dont 
l’équation est inscrite en haut de l’écran. On peut le 
faire bouger le long de l’axe de vision grâce à la molette de la souris :
les plans successifs sont obtenus par une translation de vecteur
parallèle à l’axe de vision.</P><P><B>Attention</B><BR>
Si le repère est orthonormé et si le plan de vision a pour équation :
</P><TABLE CLASS="display dcenter"><TR VALIGN="middle"><TD CLASS="dcell"><I>ax</I>+<I>by</I>+<I>cz</I>=<I>d</I> </TD></TR>
</TABLE><P> 
l’axe de vision est dirigée selon le vecteur [<I>a</I>,<I>b</I>,<I>c</I>] mais
si le repère n’est pas orthonormé ce n’est plus vrai!!!!</P><H4 CLASS="subsubsection"><A NAME="htoc51">12.3.3</A>  Comment modifier le plan de vision</H4><P><A NAME="@default25"></A>
L’orientation du plan de vision peut être modifiée en changeant l’axe de 
vision comme expliqué ci-dessus. On
peut aussi en tournant la molette de la souris
faire bouger le plan de vision par translation le 
long de l’axe de vision : cela permet d’obtenir successivement des plans 
parallèles entre eux et perpendiculaires à l’axe de vision.</P><P>On peut aussi indiquer dans <CODE>cfg</CODE> l’équation du plan
de vision.</P><P><B>Attention</B><A NAME="@default26"></A><BR>
Dans une figure 3-d, lorsqu’on déplace un point en mode 
<TT>Pointeur</TT> à l’aide de la molette de 
la souris, ce point reste dans le plan de vision, donc cela permet aussi de
translater le plan de vision.</P><H4 CLASS="subsubsection"><A NAME="htoc52">12.3.4</A>  Rotation animée du point de vue</H4><P> <A NAME="sec:anim3d"></A>
Xcas permet d’effectuer une animation par rotation du point de vue
autour d’un axe passant par l’origine du repère. L’angle de rotation varie
d’un tour en un nombre de pas configurable, de même que l’intervalle
de temps entre 2 images successives. Tous ces paramètres sont
configurables dans l’écran que l’on fait apparaitre en
cliquant sur <CODE>cfg</CODE> en bas à droite du graphe 3-d, à la ligne
commençant par <CODE>Anim</CODE>, plus précisément :
</P><UL CLASS="itemize"><LI CLASS="li-itemize">
<CODE>Anim</CODE>: est un entier qui indique le type d’animation,
la mise à 1 du bit 8 de cet entier indique que la rotation s’effectue sur
le point de vue, la mise à 1 des bits 0 à 7 de cet entier 
indique que la rotation s’effectue
sur les spots 0 à 7. La valeur par défaut est 256, c’est-à-dire que
seul le point de vue change. La valeur 255 permet de simuler
une rotation de tous les spots illuminant un objet. La valeur 1
permet de simuler une rotation du spot 1 illuminant un objet, par
exemple si cet objet est une sphère centrée en l’origine
représentant la Terre, 
on peut simuler la rotation apparente du Soleil 
pendant une journée en prenant pour axe l’axe de rotation de la sphère.
</LI><LI CLASS="li-itemize"><CODE>t</CODE>: intervalle de temps entre 2 images
</LI><LI CLASS="li-itemize"><CODE>n</CODE>: nombre d’images générées en un tour
</LI><LI CLASS="li-itemize"><CODE>x</CODE>, <CODE>y</CODE>, <CODE>z</CODE>: coordonnées de l’axe de rotation.
Ces valeurs peuvent être programmées par l’instruction
<CODE>gl_rotation_axis=[x,y,z]</CODE> où <CODE>x,y,z</CODE> sont
des valeurs numériques.
</LI><LI CLASS="li-itemize"><CODE>d</CODE>: normalement 0, peut servir à changer le numéro
d’image d’une <CODE>animation</CODE> entre 2 images d’une animation 
de rotation.
</LI></UL><P>
Le lancement de l’animation de rotation se fait par le <CODE>M</CODE>
du graphe, sous-menu 3-d ou par le raccourci clavier r.</P><P><B>Attention</B><BR>
Il ne faut pas confondre ce type d’animation avec les animations
obtenus par les instructions <CODE>animate</CODE>, <CODE>animate3d</CODE>
ou <CODE>animation</CODE>.</P><H4 CLASS="subsubsection"><A NAME="htoc53">12.3.5</A>  Les lumières des graphes 3-d</H4><P> <A NAME="sec:lumieres"></A>
Dans la configuration d’un graphe 3-d (bouton cfg en bas à droite
de la figure), on peut cocher l’option <CODE>Lights</CODE>. Dans ce cas,
au lieu de visualiser des objets émettant une couleur intrinsèque,
on va éclairer les objets avec un ou plusieurs spots lumineux. Ces
spots sont numérotés de 1 à 8 et peuvent être configurés avec les
boutons l1 à l8. Nous allons décrire brièvement dans cette section ce
type de visualisation, le lecteur souhaitant appronfondir pourra
se référer à la documentation d’OpenGL.</P><P>Il y a 2 types de spot: positionnel si <I>w</I>=1 et directionnel si <I>w</I>=0
(pour une lumière à l’infini, par exemple du Soleil). Chaque objet
a des propriétés vis-à-vis de trois type de lumière: ambiante (sans
direction privilégiée), diffuse (émise dans la direction spot-objet,
diffusée dans toutes les directions,
éventuellement atténuée selon la distance spot-objet et l’angle entre
la direction du spot et la direction spot-objet), spéculaire (réémise
préférentiellement dans la direction objet-spot). De plus un objet
peut lui-même émettre de la lumière (propriétés d’émission).</P><OL CLASS="enumerate" type=1><LI CLASS="li-enumerate">
Caractéristique géométriques :<BR>
les paramètres <I>x</I>,<I>y</I>,<I>z</I> permettent
de définir la position du spot si <I>w</I> vaut 1 ou sa direction si <I>w</I>
vaut 0.
Les paramètre <I>x</I>→, <I>y</I>→, <I>z</I>→ définissent
la direction du spot si <I>w</I> vaut 1.</LI><LI CLASS="li-enumerate">Caractéristiques de la lumière :<BR>
chaque spot fournit
<UL CLASS="itemize"><LI CLASS="li-itemize">
de la lumière
ambiante (indépendante de l’angle entre la direction spot-objet et
objet-position de l’oeil, renvoyée par le matériau selon ses
propriétés relativement à la lumière ambiante), 
</LI><LI CLASS="li-itemize">de la lumière diffuse, renvoyée dans toutes les directions
sans préférence, en fonction des
propriétés de lumière diffuse du matériau, avec un
coefficient d’atténuation dépendant du cosinus de l’angle 
β entre la direction spot-objet (si <I>w</I>=1) ou
direction du spot (si <I>w</I>=0) et la normale à l’objet,
</LI><LI CLASS="li-itemize">de la lumière spéculaire, permettant
d’émuler une réflexion sur un miroir ou un aspect laqué, 
cette lumière sera renvoyée 
par l’objet en fonction de ses propriétés spéculaires,
préférentiellement dans la direction d’émission, plus précisément
en fonction du cosinus de γ, 
l’angle entre le symétrique de la direction d’émission avec la normale
à l’objet avec la direction
objet-oeil, le cosinus est élevé à la puissance définie par le paramètre 
“gl_shininess” de l’objet. 
</LI></UL>
On définit pour chaque type de lumière ses 4 composantes (r: red=rouge, g:
green=vert, b: blue=bleu, a: alpha=transparence) par un réel compris
entre 0 et 1 (maximum). Par exemple, pour voir une scène en lumière
bleue, on mettrait 0 sur les canaux r et g et 1 sur le canal b.
On utilise en général les mêmes valeurs pour la lumière diffuse et
spéculaire, 1,1,1,1 pour les propriétés spéculaires d’un
objet de type miroir, et des valeurs correspondant à la couleur
pour les propriétés d’émission et de diffusion d’un objet.</LI><LI CLASS="li-enumerate">Caractéristique d’émission du spot : 
<UL CLASS="itemize"><LI CLASS="li-itemize">
<CODE>exp</CODE> est un entier, c’est un coefficient permettant de régler
l’atténuation de la lumière. Plus précisément il s’agit de
l’exposant du cosinus de l’angle α entre la direction du spot
et la direction spot-objet éclairé, 
il n’y a pas d’atténuation si <I>w</I>=0), on utilise 0 ou 1 ou plus selon
que l’on souhaite un spot moins ou plus focalisé, 
</LI><LI CLASS="li-itemize"><CODE>cutoff</CODE> permet de régler l’angle θ du cône (d’axe
la direction du spot) où le spot
envoie de la lumière, il vaut 180 si le spot est isotrope 
(émet identiquement dans toutes les directions) 
ou une valeur entre 0 et 90 en degrés sinon, dans ce cas aucune
lumière n’est reçue si l’angle α est supérieur à θ.
</LI><LI CLASS="li-itemize">les coefficients <CODE>att0</CODE> à <CODE>att2</CODE> permettent d’atténuer
la lumière d’un spot positionnel
en fonction de la distance <I>d</I> spot-objet, en la multipliant par
<TABLE CLASS="display dcenter"><TR VALIGN="middle"><TD CLASS="dcell"><TABLE CLASS="display"><TR><TD CLASS="dcell" ALIGN="center">1</TD></TR>
<TR><TD CLASS="hbar"></TD></TR>
<TR><TD CLASS="dcell" ALIGN="center"><I>a</I><SUB>0</SUB>+<I>a</I><SUB>1</SUB> <I>d</I> +<I>a</I><SUB>2</SUB> <I>d</I><SUP>2</SUP></TD></TR>
</TABLE></TD><TD CLASS="dcell"> </TD></TR>
</TABLE>
</LI></UL>
</LI></OL><P>Finalement, sur chaque canal de couleur, la luminosité est obtenue par
la formule :
</P><TABLE CLASS="display dcenter"><TR VALIGN="middle"><TD CLASS="dcell"><TABLE CELLSPACING=6 CELLPADDING=0><TR><TD ALIGN=right NOWRAP> <I>l</I></TD><TD ALIGN=center NOWRAP>=</TD><TD ALIGN=left NOWRAP><TABLE CLASS="display"><TR VALIGN="middle"><TD CLASS="dcell"><I>o</I><SUB><I>e</I></SUB>+ <I>o</I><SUB><I>a</I></SUB> </TD><TD CLASS="dcell"><TABLE CLASS="display"><TR><TD CLASS="dcell" ALIGN="center">8</TD></TR>
<TR><TD CLASS="dcell" ALIGN="center"><FONT SIZE=6>∑</FONT></TD></TR>
<TR><TD CLASS="dcell" ALIGN="center"><I>j</I>=1</TD></TR>
</TABLE></TD><TD CLASS="dcell"> <I>l</I><SUB><I>a</I>,<I>j</I></SUB> + <I>o</I><SUB><I>s</I></SUB> </TD><TD CLASS="dcell"><TABLE CLASS="display"><TR><TD CLASS="dcell" ALIGN="center">8</TD></TR>
<TR><TD CLASS="dcell" ALIGN="center"><FONT SIZE=6>∑</FONT></TD></TR>
<TR><TD CLASS="dcell" ALIGN="center"><I>j</I>=1</TD></TR>
</TABLE></TD><TD CLASS="dcell"> <I>l</I><SUB><I>s</I>,<I>j</I></SUB>
cos(γ<SUB><I>j</I></SUB>)<SUP><I>S</I></SUP> + </TD></TR>
</TABLE></TD></TR>
<TR><TD ALIGN=right NOWRAP>&nbsp;</TD><TD ALIGN=center NOWRAP>&nbsp;</TD><TD ALIGN=left NOWRAP><TABLE CLASS="display"><TR VALIGN="middle"><TD CLASS="dcell">+  <I>o</I><SUB><I>d</I></SUB> </TD><TD CLASS="dcell"><TABLE CLASS="display"><TR><TD CLASS="dcell" ALIGN="center">8</TD></TR>
<TR><TD CLASS="dcell" ALIGN="center"><FONT SIZE=6>∑</FONT></TD></TR>
<TR><TD CLASS="dcell" ALIGN="center"><I>j</I>=1</TD></TR>
</TABLE></TD><TD CLASS="dcell"> <I>l</I><SUB><I>d</I>,<I>j</I></SUB> 
cos(α<SUB><I>j</I></SUB>)<SUP><I>e</I><SUB><I>j</I></SUB></SUP> cos(β<SUB><I>j</I></SUB>) </TD><TD CLASS="dcell"><TABLE CLASS="display"><TR><TD CLASS="dcell" ALIGN="center">1</TD></TR>
<TR><TD CLASS="hbar"></TD></TR>
<TR><TD CLASS="dcell" ALIGN="center"><I>a</I><SUB>0,<I>j</I></SUB>+<I>a</I><SUB>1,<I>j</I></SUB>
<I>d</I><SUB><I>j</I></SUB>+<I>a</I><SUB>2,<I>j</I></SUB> <I>d</I><SUB><I>j</I></SUB><SUP>2</SUP></TD></TR>
</TABLE></TD><TD CLASS="dcell"> </TD></TR>
</TABLE></TD></TR>
</TABLE></TD></TR>
</TABLE><P>
où :
</P><UL CLASS="itemize"><LI CLASS="li-itemize">
<I>o</I><SUB><I>e</I></SUB>,<I>o</I><SUB><I>a</I></SUB>,<I>o</I><SUB><I>d</I></SUB>,<I>o</I><SUB><I>s</I></SUB> désignent la valeur pour le canal de couleur
de l’objet en émission, ambiante, diffuse, spéculaire et <I>S</I> désigne
l’exposant “shininess”de l’objet
</LI><LI CLASS="li-itemize"><I>l</I><SUB><I>a</I>,<I>j</I></SUB>,<I>l</I><SUB><I>d</I>,<I>j</I></SUB>,<I>l</I><SUB><I>s</I>,<I>j</I></SUB> désignent la valeur pour le canal de couleur
du spot <I>j</I> en ambiant, diffuse, spéculaire
</LI><LI CLASS="li-itemize"><I>a</I><SUB>0,<I>j</I></SUB>, <I>a</I><SUB>1,<I>j</I></SUB>, <I>a</I><SUB>2,<I>j</I></SUB> désignent les coefficients
d’atténuation du spot <I>j</I>, remplacés par 1,0,0 si <I>w</I>=0 (pas
d’atténuation)
</LI><LI CLASS="li-itemize"><I>d</I><SUB><I>j</I></SUB> est la distance du spot <I>j</I> à l’objet
</LI><LI CLASS="li-itemize">α<SUB><I>j</I></SUB> est l’angle entre la direction du spot <I>j</I> et du
segment reliant le spot <I>j</I> et la facette de l’objet, sauf si α<SUB><I>j</I></SUB> est
supérieur à l’angle de cutoff du spot <I>j</I> (α<SUB><I>j</I></SUB>=π/2), 
ou si <I>w</I>=0 (α<SUB><I>j</I></SUB>=0, pas d’atténuation directionnelle).
</LI><LI CLASS="li-itemize">β<SUB><I>j</I></SUB> est l’angle entre le segment spot <I>j</I>-objet et
la normale à la facette de l’objet (si <I>w</I>=0 on remplace spot <I>j</I>-objet par
direction du spot)
</LI><LI CLASS="li-itemize">γ<SUB><I>j</I></SUB> est l’angle entre le symétrique de la direction 
du spot par rapport à la normale à la facette de l’objet 
et le segment objet-oeil
</LI></UL><P>
Si on ne coche pas l’option Blend (pas de transparence), les objets
situés devant d’autres objets les masquent complètement.
Si on coche l’option Blend, la valeur du canal a (alpha=transparence)
est utilisée pour composer la luminance des objets précédents avec
celle de l’objet représenté ensuite.
Enfin, l’option Gouraud permet de lisser la représentation des
surfaces par des facettes (ce sont des facettes quadrangulaires
sauf pour les surfaces implicites qui sont triangulées).</P>Retour &#XE0; la page personnelle de <A HREF="http://www-fourier.ujf-grenoble.fr/parisse">Bernard Parisse</A>.<HR>
<A HREF="casinter014.html"><IMG SRC="previous_motif.gif" ALT="Previous"></A>
<A HREF="index.html"><IMG SRC="contents_motif.gif" ALT="Up"></A>
<A HREF="casinter016.html"><IMG SRC="next_motif.gif" ALT="Next"></A>
</BODY>
</HTML>
