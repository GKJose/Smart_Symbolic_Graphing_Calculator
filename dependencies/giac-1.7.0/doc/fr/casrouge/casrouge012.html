<!DOCTYPE html>
<html >
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="generator" content="hevea 2.29+5 of 2017-05-18">
<link rel="stylesheet" type="text/css" href="casrouge.css">
<title>Codage</title>
</head>
<body >
<a href="casrouge011.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="casrouge013.html"><img src="next_motif.gif" alt="Next"></a>
<hr>
<h1 id="sec325" class="chapter">Chapitre 12  Codage</h1>
<h2 id="sec326" class="section">12.1  Codage de Jules Cesar</h2>
<p><a id="sec:Cesar"></a>
</p>
<h3 id="sec327" class="subsection">12.1.1  Introduction</h3>
<p>
Le principe est simple : on écrit un message en n’utilisant que les 26 
lettres de l’alphabet et on le code en remplacant une lettre par une autre 
lettre.
Ceci peut être considéré comme une application <span style="font-style:italic">f</span> de l’ensemble 
des lettres {A,B,C,...X,Y,Z} dans lui-même.<br>
Pour pouvoir décoder, il faut que l’application <span style="font-style:italic">f</span> ci-dessus soit 
bijective!<br>
Il parait que Jules César utilisait cette méthode pour communiquer ses 
ordres.
</p>
<h3 id="sec328" class="subsection">12.1.2  Codage par symétrie point ou par rotation d’angle π</h3>
<p><a id="sec:symp"></a>
Une façon simple de coder est la suivante :<br>
on écrit les lettres sur un cercle (de façon équirépartie) et on 
remplace chaque lettre par la lettre symétrique par rapport au centre du 
cercle :</p><p><img src="casrouge007.png"></p><p>Le décodage s’obtient de la même façon car ici <span style="font-style:italic">f</span> ∘ <span style="font-style:italic">f</span>=<span style="font-style:italic">Id</span> </p>
<h3 id="sec329" class="subsection">12.1.3  Avec les élèves</h3>
<p>
On explique que l’on va coder un message en remplacant une lettre par une autre
(on suppose que le message n’utilise que les 26 lettres de l’alphabet et que 
l’on n’écrit pas les espaces). <br>
Pour cela on distribue une feuille sur laquelle figure quatre cercles divisés
en 26 parties égales.<br>
 On écrit sur ce cercle les 26 lettres de l’alphabet et le codage consiste 
à remplacer chaque lettre du message par la lettre diamétralement opposéesur le cercle.<br>
Par exemple voici le message à coder selon cette méthode :<br>
"BONJOURLESAMIS"<br>
Le message à décoder est donc :<br>
"OBAWBHEYRFNZVF"<br>
Quel sont les éléments pertinents qu’il faut transmettre pour que le
décodage soit possible ?<br>
Parmi les réponses il est apparu qu’il fallait ajouter +13 pour décoder.<br>
Puis chaque élève invente un codage et écrit un message selon son codage
et le donne à décoder à son voisin, par écrit avec les explications 
nécessaires pour le décoder.<br>
Voici quelques codages obtenus :<br>
- codage obtenu en remplacant chaque lettre par celle qui la suit dans 
l’alphabet,<br>
- codage obtenu en remplacant chaque lettre par celle qui est obtenue en 
avançant de +4 sur la roue (ou en reculant de 3 etc...),<br>
- codage obtenu en remplaçant chaque lettre par celle qui est obtenue
par symétrie par rapport à la droite [A,N] (verticale sur le dessin),ou par 
symétrie par rapport à la droite horizontale sur le dessin,<br>
- codage par symétrie par rapport au centre du cercle mais où l’ordre des 
lettres sur le cercle n’est pas respecté,<br>
- d’autres codages comme de remplacer le message par une suite de nombres 
(intéressant mais cela ne repond pas à la question posée),<br>
- codage qui dépend de la position de la lettre dans le message. Ce codage
n’est pas une application puisque une même lettre peut avoir des codages 
différents.<br>
Combien y-a-t-il de codages (i.e de bijections) possibles ?<br>
Il a fallut parler de bijections :<br>
un étudiant a dit qu’il fallait que deux lettres différentes soient codées par
des lettres différentes pour que le décodage soit possible (injection).<br>
Ceci entraine que toutes les lettres sont le codage d’une autre lettre
(surjection).<br>
Pour simplifier on a préféré parler de permutations des lettres avec comme
exemple : trouver tous les codages possibles si on suppose que l’alphabet 
utilisé ne comporte que les trois lettres A, B, C.<br>
Donnez un ordre de grandeur de 26!<br>
A supposer que vous vouliez écrire les 26! codages possibles sur un cahier et
que votre rythme est de 1 codage par seconde (vous êtes super rapide !!!...
félicitations !!!) combien de temps (réponse en heures, en mois, en années...?) 
vous faut-il ?<br>
Combien de cahiers de 10000 lignes (200 pages de 50 lignes) vous faut-il ? 
Donner la longueur occupée par ces cahiers dans une bibliothèque, si chaque
cahier occupe 1 cm. 
Combien y-a-t-il de codages involutifs possibles qui sont sans point double 
(c’est à dire de bijections <span style="font-style:italic">f</span>
vérifiant <span style="font-style:italic">f</span>=<span style="font-style:italic">f</span><sup>−1</sup> et <span style="font-style:italic">f</span>(<span style="font-style:italic">x</span>)≠ <span style="font-style:italic">x</span>  pour tout <span style="font-style:italic">x</span>) ?<br>
Comment faire pour que la clé du décodage soit simple ?
</p>
<h3 id="sec330" class="subsection">12.1.4  Travail dans Z/26Z</h3>
<p>
Le codage de Jules César consiste à faire une symétrie point ou encore 
une rotation d’angle π.<br>
Si on numérote les lettres de 0 à 25, le codage consiste donc à faire 
une addition de 13 (modulo 26). 
(voir figure <a href="#sec%3Asymp">12.1.2</a>).<br>
<span style="font-weight:bold">Exemple</span> :<br>
"BONJOUR" sera codé par "OBAWBHE"</p>
<h3 id="sec331" class="subsection">12.1.5  Codage par rotation d’angle α=<span style="font-style:italic">k</span>*π/13</h3>
<p><a id="sec:rotn"></a>
Le principe est le même :<br>
on écrit les lettres sur un cercle (de façon équirépartie) et on remplace 
chaque lettre par la lettre obtenue par rotation d’angle 
α=<span style="font-style:italic">k</span>*π/13 (0≤  <span style="font-style:italic">k</span> ≤  25) (k est un entier).<br>
Si on numérote les lettres de 0 à 25, le codage consiste donc à faire subir
à chaque lettre un décalage de <span style="font-family:monospace">k</span> c’est à dire à faire subir à son 
numéro une addition de <span style="font-family:monospace">k</span> (modulo 26) (voir figure <a href="#sec%3Arotn">12.1.5</a>).<br>
On remarquera que si le paramètre de codage par rotation est <span style="font-family:monospace">k</span>, le 
décodage sera un codage par rotation de paramètre <span style="font-family:monospace">-k</span> ou encore
<span style="font-family:monospace">26-k</span>.</p><p><img src="casrouge008.png">
</p>
<h2 id="sec332" class="section">12.2  Écriture des programmes correspondants</h2>
<h3 id="sec333" class="subsection">12.2.1  Passage d’une lettre à un entier entre 0 et 25</h3>
<p><a id="hevea_default89"></a>
À chaque lettre on peut faire correspondre son code ASCII.<br>
Avec <span style="font-family:monospace">Xcas</span>, <span style="font-family:monospace">asc("A")=[65]</span> et <span style="font-family:monospace">asc("BON")=[66,79,78]</span>.<br>
 Donc pour avoir un entier entre 
0 et 25 il suffit de retrancher 65 :<br>
 <span style="font-family:monospace">asc("A")-65</span> (<span style="font-family:monospace">=0</span>) ou <span style="font-family:monospace">asc("BON")-[65,65,65]</span> (<span style="font-family:monospace">=[1,14,13]</span>).<br>
On écrit donc la procédure <span style="font-family:monospace">c2n</span> qui transforme une chaîne de caractères 
<span style="font-family:monospace">m</span> en une liste d’entiers <span style="font-family:monospace">l=c2n(m)</span> entre 0 et 25 (le 2 de <span style="font-family:monospace">c2n</span> veut dire "to" ou "vers" en français).<br>
Il faut créer une liste formée des nombres <span style="font-family:monospace">65</span> et de même longueur que le message avec <span style="font-family:monospace">makelist(65,1,size(m))</span>.<br>
On écrit :
</p><pre class="verbatim">c2n(m):={
return(asc(m)-makelist(65,1,size(m)));
}
</pre><p>
<span style="font-weight:bold">Exemple</span> :<br>
<span style="font-family:monospace">c2n("BONJOUR")=[1,14,13,9,14,20,17]</span>
</p>
<h3 id="sec334" class="subsection">12.2.2  Passage d’un entier entre 0 et 25 à une lettre</h3>
<p><a id="hevea_default90"></a>
À chaque entier <span style="font-style:italic">n</span> compris entre 0 et 25, on fait correspondre la 
(<span style="font-style:italic">n</span>−1)<sup><span style="font-style:italic">ieme</span></sup> lettre en majuscule de l’alphabet (à 0 correspond "A", 
‘a 1 correspond "B" etc...).<br>
Avec <span style="font-family:monospace">Xcas</span>, <span style="font-family:monospace">char(65)="A"</span> et <span style="font-family:monospace">char([66,79,78])="BON"</span>.<br>
On écrit donc la procédure <span style="font-family:monospace">n2c</span> qui transforme une liste d’entiers 
<span style="font-family:monospace">l</span>
entre 0 et 25 en une chaîne de caractères <span style="font-family:monospace">m</span>.<br>
Il faut penser à ajouter <span style="font-family:monospace">65</span> à tous les éléments de la liste 
<span style="font-family:monospace">l</span> (on forme une liste formée de <span style="font-family:monospace">65</span> avec la fonction 
<span style="font-family:monospace">makelist</span> :
<span style="font-family:monospace">l+makelist(65,1,size(l))</span>).<br>
On écrit :
</p><pre class="verbatim">n2c(l):={
return(char(l+makelist(65,1,size(l))));
}
</pre><p><span style="font-weight:bold">Exemple</span> :<br>
<span style="font-family:monospace">n2c([1,14,13,9,14,20,17])="BONJOUR"</span> 
</p>
<h3 id="sec335" class="subsection">12.2.3  Passage d’un entier k entre 0 et 25 à l’entier n+k mod 26</h3>
<p>
On écrit donc la procédure <span style="font-family:monospace">decal</span> de paramètres <span style="font-family:monospace">n</span> et <span style="font-family:monospace">l</span> qui 
transforme une liste <span style="font-family:monospace">l</span> d’entiers <span style="font-family:monospace">k</span> entre 0 et 25 en la liste d’entiers 
<span style="font-family:monospace"><span style="font-style:italic">n</span></span><span style="font-family:monospace">+</span><span style="font-family:monospace"><span style="font-style:italic">k</span></span><span style="font-family:monospace">  </span><span style="font-family:monospace"><span style="font-style:italic">mod</span></span><span style="font-family:monospace"> 26</span>.<br>
On écrit :
</p><pre class="verbatim">decal(n,l):={
return(irem(l+makelist(n,1,size(l)),26));
}
</pre><p>
<span style="font-weight:bold">Exemple</span> :<br>
<span style="font-family:monospace">decal(13,[1,14,13,9,14,20,17])=[14,1,0,22,1,7,4]</span>
</p>
<h3 id="sec336" class="subsection">12.2.4  Codage d’un message selon Jules César</h3>
<p>
On écrit la procédure finale <span style="font-family:monospace">CESAR</span> qui a deux paramètres :<br>
l’entier <span style="font-family:monospace">n</span> de décalage et le message <span style="font-family:monospace">m</span>.<br>
On écrit :
</p><pre class="verbatim">cesar(n,m):={
return(n2c(decal(n,c2n(m))));
}
</pre><p>
<span style="font-weight:bold">Exemple</span> :<br>
<span style="font-family:monospace">cesar(13,"BONJOUR")="OBAWBHE"</span>
</p>
<h2 id="sec337" class="section">12.3  Codage en utilisant une symétrie par rapport à un axe</h2>
<blockquote class="figure"><div class="center"><div class="center"><hr style="width:80%;height:2"></div>
<div class="caption"><table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="vertical-align:top;text-align:left;" >Figure 12.1: Codage par symétrie par rapport à Ox</td></tr>
</table></div><a id="sec:symd"></a>
<div class="center"><hr style="width:80%;height:2"></div></div></blockquote>
<h3 id="sec338" class="subsection">12.3.1  Passage d’un entier k entre 0 et 25 à l’entier n-k mod 26</h3>
<p>
On reprend les procédures <span style="font-family:monospace">c2n</span> et <span style="font-family:monospace">n2c</span> vues précédemment :<br>
<span style="font-family:monospace">c2n</span> transforme une chaîne
de caractères <span style="font-family:monospace">m</span> en une liste d’entiers entre 0 et 25 et <span style="font-family:monospace">n2c</span> 
transforme une liste <span style="font-family:monospace">l</span> d’entiers entre
0 et 25 en une chaîne de caractères <span style="font-family:monospace">m</span>.<br>
On écrit ensuite la procédure <span style="font-family:monospace">sym</span> de paramètres <span style="font-family:monospace">n</span> et <span style="font-family:monospace">l</span> qui
transforme une liste <span style="font-family:monospace">l</span> d’entiers <span style="font-family:monospace">k</span> entre 0 et 25 en la liste 
d’entiers <span style="font-family:monospace"><span style="font-style:italic">n</span></span><span style="font-family:monospace">-</span><span style="font-family:monospace"><span style="font-style:italic">k</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="font-style:italic">mod</span></span><span style="font-family:monospace"> 26</span>.
On peut considérer que le paramètre <span style="font-family:monospace">n</span> détermine le diamètre <span style="font-family:monospace">D</span>
perpendiculaire à la corde <span style="font-family:monospace">[0,n]</span> (joignant <span style="font-family:monospace">A</span> à la <span style="font-family:monospace">(n-1)ième</span> lettre).<br>
La procédure <span style="font-family:monospace">sym</span> de paramètre 
<span style="font-family:monospace">n</span> est donc une symétrie par rapport à la droite <span style="font-family:monospace">D</span>.<br>
On écrit :
</p><pre class="verbatim">sym(n,l):={
return(irem(makelist(n,1,size(l))-l,26));
}
</pre>
<h3 id="sec339" class="subsection">12.3.2  Codage d’un message selon une symétrie droite D</h3>
<p>
On écrit la procédure finale <span style="font-family:monospace">cesarsym</span> qui a deux paramètres :<br>
l’entier <span style="font-family:monospace">n</span> (définissant la corde <span style="font-family:monospace">[0,n]</span> normale au diamètre <span style="font-family:monospace">D</span>)
et le message <span style="font-family:monospace">m</span>.<br>
On écrit :
</p><pre class="verbatim">cesarsym(n,m):={
return(n2c(sym(n,c2n(m))));
}
</pre><p>
<span style="font-weight:bold">Exemple</span> :<br>
Si on prend <span style="font-family:monospace">n=13</span> on réalise une symétrie par rapport à la droite <span style="font-family:monospace">Ox</span>
(cf figure <a href="#sec%3Asymd">12.1</a>).<br>
<span style="font-family:monospace">cesarsym(13,"BONJOUR")="MZAEZTW"</span>
</p>
<h2 id="sec340" class="section">12.4  Codage en utilisant une application affine</h2>
<p>
Comme précédemment, on écrit la procédure <span style="font-family:monospace">c2n</span> qui transforme une chaîne
de caractères <span style="font-family:monospace">m</span> en une liste d’entiers entre 0 et 25 et on écrit 
la procédure <span style="font-family:monospace">n2c</span> qui transforme une liste <span style="font-family:monospace">l</span> d’entiers entre 
0 et 25 en une chaîne de caractères <span style="font-family:monospace">m</span>.<br>
On écrit ensuite la procédure <span style="font-family:monospace">affine</span> de paramètre <span style="font-family:monospace">a,b,l</span> qui
transforme une liste <span style="font-family:monospace">l</span> d’entiers <span style="font-family:monospace">k</span> entre 0 et 25 en la liste 
d’entiers <span style="font-family:monospace"><span style="font-style:italic">a</span></span><span style="font-family:monospace">*</span><span style="font-family:monospace"><span style="font-style:italic">k</span></span><span style="font-family:monospace">+</span><span style="font-family:monospace"><span style="font-style:italic">b</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="font-style:italic">mod</span></span><span style="font-family:monospace"> 26</span>.<br>
On écrit :
</p><pre class="verbatim">affine(a,b,l):={
return(irem((a*l+makelist(b,1,size(l))),26));
}
</pre><p>
On écrit ensuite :
</p><pre class="verbatim">cesaraffine(a,b,m):={
return(n2c(affine(a,b,c2n(m))));
}
</pre><p>
Question :<br>
Pour quelles valeurs de <span style="font-style:italic">a</span> et <span style="font-style:italic">b</span> le codage obtenu par <span style="font-family:monospace">cesaraffine</span> peut-il être décodé ?</p>
<h2 id="sec341" class="section">12.5  Codage en utilisant un groupement de deux lettres</h2>
<p>
On écrit la procédure <span style="font-family:monospace">c2n2</span> qui transforme une chaîne de caractères
<span style="font-family:monospace">m</span> en une liste <span style="font-family:monospace">l</span> d’entiers entre 0 et 26<sup>2</sup>−1=675 :<br>
On fait des groupements de deux lettres (quitte à terminer le message par la 
lettre "F" pour avoir un nombre pair de lettres), chaque groupement est
considéré comme l’écriture en base 26 d’un entier en utilisant comme 
"chiffre" les lettres majuscules. Ainsi, <span style="font-family:monospace">"BC"</span> est l’écriture en base 26 de 28 (28=1*26+2). <br>
On écrit :
</p><pre class="verbatim">c2n2(m):={
local s,lr,l,n;
s:=size(m);
if (irem(s,2)==1){
m:=append(m,"F");
s:=s+1;
}
lr:=[];
l:=asc(m);
for (k:=0;k&lt;s;k:=k+2){
n:=l[k]*26+l[k+1];
lr:=append(lr,n);
}
return(lr);
}
</pre><p>On écrit ensuite la procédure <span style="font-family:monospace">n2c2</span> qui transforme une liste 
d’entiers 
entre 0 et 675 (675=25*26+25=26*26-1) en une chaîne de caractères 
<span style="font-family:monospace">m</span> :<br>
chaque entier étant écrit en base 26 avec comme "symboles" les 26 lettres 
majuscules.<br>
On écrit :
</p><pre class="verbatim">n2c2(l):={
local s,n,m;
s:=size(l);
m:="";
for (k:=0;k&lt;s;k++){
n:=l[k];
m:=append(m,char(iquo(n,26)+65));
m:=append(m,char(irem(n,26)+65));
}
return(m);
}
</pre><p>
On écrit ensuite la fonction <span style="font-family:monospace">affin2</span> de paramètre <span style="font-family:monospace">a,b,l</span> qui
transforme une liste <span style="font-family:monospace">l</span> d’entiers <span style="font-family:monospace">k</span> entre 0 et 675 en la liste 
d’entiers <span style="font-family:monospace"><span style="font-style:italic">a</span></span><span style="font-family:monospace">*</span><span style="font-family:monospace"><span style="font-style:italic">k</span></span><span style="font-family:monospace">+</span><span style="font-family:monospace"><span style="font-style:italic">b</span></span><span style="font-family:monospace"> </span><span style="font-family:monospace"><span style="font-style:italic">mod</span></span><span style="font-family:monospace"> 676</span> (entiers encore compris entre 0 et 675).<br>
On écrit :
</p><pre class="verbatim">affin2(a,b,l):={
local s;
s:=size(l);
for (k:=0;k&lt;s;k++){
l[k]:=irem(a*l[k]+b,676);
}
return(l);
}
</pre><p>
On écrit ensuite la fonction <span style="font-family:monospace">cesar2</span> qui réalise le codage par 
groupement de 2 lettres utilisant l’application affine <span style="font-family:monospace">affin2</span>:
</p><pre class="verbatim">cesar2(a,b,m):={
return(n2c2(affin2(a,b,c2n2(m))));
}
</pre><p>
<span style="font-weight:bold">Question</span> :<br>
Pour quelles valeurs <span style="font-style:italic">a</span>1 de <span style="font-style:italic">a</span> et <span style="font-style:italic">b</span>1 de <span style="font-style:italic">b</span>, le codage obtenu par 
<span style="font-family:monospace">cesaraffine</span> peut-il être décodé ?<br>
<span style="font-weight:bold">Réponse</span> :<br>
On doit avoir <span style="font-style:italic">a</span>1*(<span style="font-style:italic">a</span>*<span style="font-style:italic">n</span>+<span style="font-style:italic">b</span>)+<span style="font-style:italic">b</span>1=<span style="font-style:italic">a</span>1*<span style="font-style:italic">a</span>*<span style="font-style:italic">n</span>+<span style="font-style:italic">a</span>1*<span style="font-style:italic">b</span>+<span style="font-style:italic">b</span>1=<span style="font-style:italic">n</span>.<br>
Il suffit donc de prendre : <span style="font-style:italic">b</span>1=−<span style="font-style:italic">a</span>1*<span style="font-style:italic">b</span> mod676 et <span style="font-style:italic">a</span>1*<span style="font-style:italic">a</span>=1 mod676
</p>
<h2 id="sec342" class="section">12.6  Le codage Jules César et le codage linéaire</h2>
<h3 id="sec343" class="subsection">12.6.1  Les caractères et leurs codes</h3>
<p><a id="sec:code"></a>
Ici, on ne se borne plus aux 26 lettres de l’alphabet, mais on veut pouvoir 
utiliser les 101 caractères de la table ci-dessous.<br>
Dans cette table, on a le code du caractère, puis, le caractère : ainsi
"5" a pour code 21 et "R" a pour code 50 et l’espace " " a pour code 0.<br>
 <br>

</p><table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="text-align:left;border:solid 1px;white-space:nowrap" > 0</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" > 1  !</td><td style="text-align:left;border:solid 1px;white-space:nowrap" > 2  "</td><td style="text-align:left;border:solid 1px;white-space:nowrap" > 3 #</td><td style="text-align:left;border:solid 1px;white-space:nowrap" > 4 $</td><td style="text-align:left;border:solid 1px;white-space:nowrap" > 5 %</td><td style="text-align:left;border:solid 1px;white-space:nowrap" > 6 &amp;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" > 7  ’</td><td style="text-align:left;border:solid 1px;white-space:nowrap" > 8 (</td><td style="text-align:left;border:solid 1px;white-space:nowrap" > 9 )</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >10 * </td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" >11 +</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >12 ,</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >13 -</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >14 .</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >15 /</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >16 0</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >17 1</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >18 2</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >19 3</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >20 4 </td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" >21 5</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >22 6</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >23 7</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >24 8</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >25 9</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >26 :</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >27  ;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >28 &lt;</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >29 =</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >30 &gt; </td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" >31 ?</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >32 @</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >33 A</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >34 B</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >35 C</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >36 D</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >37 E</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >38 F</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >39 G</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >40 H </td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" >41 I</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >42 J</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >43 K</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >44 L</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >45 M</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >46 N</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >47 O</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >48 P</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >49 Q</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >50 R </td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" >51 S</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >52 T</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >53 U</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >54 V</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >55 W</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >56 X</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >57 Y</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >58 Z</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >59 [</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >60 \ </td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" >61 ]</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >62 &63 _</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >64 ‘</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >65 a</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >66 b</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >67 c</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >68 d</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >69 e</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >70 f </td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" >71 g</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >72 h</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >73 i</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >74 j</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >75 k</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >76 l</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >77 m</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >78 n</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >79 o</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >80 p </td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" >81 q</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >82 r</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >83 s</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >84 t</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >85 u</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >86 v</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >87 w</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >88 x</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >89 y</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >90 z </td></tr>
<tr><td style="text-align:left;border:solid 1px;white-space:nowrap" >91 {</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >92 |</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >93 }</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >94 &95 ê</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >96 ù</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >97 ç</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >98 à</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >99 è</td><td style="text-align:left;border:solid 1px;white-space:nowrap" >100 é </td></tr>
</table><p><br>
</p>
<h3 id="sec344" class="subsection">12.6.2  Les différentes étapes du codage</h3>
<p>
Voici les différentes étapes du codage (elles seront programmées avec 
<span style="font-family:monospace">Xcas</span> dans le paragraphe suivant) :
</p><ol class="enumerate" type=1><li class="li-enumerate">
À chaque lettre ou symbole,
on associe un nombre, comme dans la table <a href="#sec%3Acode">12.6.1</a>. Un texte devient ainsi 
une suite de nombres : par exemple <span style="font-family:monospace">ê</span> sera codée par 95 et
<span style="font-family:monospace">BONJOUR</span> par 34 47 46 42 47 53 50.<br>
La fonction <span style="font-family:monospace">codec2n</span> réalise cette étape : elle transforme un 
caractère en un nombre <span style="font-style:italic">n</span> (0 ≤ <span style="font-style:italic">n</span>&lt; 101), selon la table <a href="#sec%3Acode">12.6.1</a>.
</li><li class="li-enumerate">On effectue une ou plusieurs opérations sur ces nombres :
<ul class="itemize"><li class="li-itemize">
pour le codage de Jules César, on ajoute à ces nombres un nombre 
fixé appelé clef de chiffrement (par exemple 17), puis on prend le 
reste de la division par 101 des nombres obtenus.
Ainsi avec ce codage, <span style="font-family:monospace">ê</span> est transformé 95
qui est transformé en 11 (95+17=112 =101+11, ou encore, 11 est le reste 
de la division de 112 par 101).<br>
Avec <span style="font-family:monospace">Xcas</span>, on effectue la transformation de <span style="font-family:monospace">n</span> avec la commande 
<span style="font-family:monospace">irem(n+clef,101)</span>, où <span style="font-family:monospace">clef</span> est une variable qui contient la clef 
de chiffrement. 
</li><li class="li-itemize">pour le codage linéaire on multiplie ces nombres par un nombre 
fixé appelé clef de chiffrement (par exemple 17) puis on prend le reste de la division par 101 des nombres obtenus.
Ainsi avec ce codage <span style="font-family:monospace">ê</span> est transformé 95 qui est 
transformé en 100 (95*17=1615 =15*101+100, ou encore, 100 est le reste de la
division de 1615 par 101).<br>
Avec <span style="font-family:monospace">Xcas</span>, on effectue la transformation de <span style="font-family:monospace">n</span> avec la commande :<br>
<span style="font-family:monospace">irem(n*clef,101)</span><br>
 si <span style="font-family:monospace">clef</span> est une variable qui contient la clef de chiffrement.
</li></ul>
</li><li class="li-enumerate">On transforme ensuite cette suite de nombre en une suite de caractères,
c’est le message crypté. 
Ainsi, avec le codage de Jules César de clef 17, <span style="font-family:monospace">ê</span> devient 
<span style="font-family:monospace">+</span> et <span style="font-family:monospace">BONJOUR</span> devient 
<span style="font-family:monospace">S‘_|‘fc</span> et 
avec le codage linéaire de clef 17, <span style="font-family:monospace">ê</span> devient 
<span style="font-family:monospace">é</span> et <span style="font-family:monospace">BONJOUR</span> devient 
<span style="font-family:monospace">i|k’|}J</span>.<br>
La fonction <span style="font-family:monospace">coden2c</span> réalise cette étape : elle transforme un nombre 
<span style="font-style:italic">n</span> (0 ≤ <span style="font-style:italic">n</span>&lt; 101) en un caractère <span style="font-style:italic">c</span>, selon la table <a href="#sec%3Acode">12.6.1</a>.
</li><li class="li-enumerate">Le décryptage nécessite d’inverser les opérations 3, 2 et 1.
Dans les exemples :
<ul class="itemize"><li class="li-itemize">
avec le codage de Jules César, il faut enlever 17 ou rajouter 84
et prendre le reste de la division par 101, 
(84 est la clef de déchiffrement car 84+17=101). Ainsi, 11 est décripté par
95 puisque 11+84=95.
</li><li class="li-itemize">avec le codage linéaire, il faut multiplier par 6 et prendre 
le reste de la division par 101, (6 est la clef de déchiffrement car 
6*17=102=101+1). Ainsi, 100 est décripté par 95 puisque 100*6=5*101+95.
</li></ul> 
Le calcul de la
clef de déchiffrement à partir de la clef de chiffrement
fait intervenir l’arithmétique des entiers :<br>
- savoir trouver l’opposé <span style="font-style:italic">u</span> d’un élément <span style="font-style:italic">n</span> de <span style="font-style:italic">Z</span>/101<span style="font-style:italic">Z</span> pour le 
codage de Jules César (<span style="font-style:italic">u</span>=101−<span style="font-style:italic">n</span> car <span style="font-style:italic">u</span>+<span style="font-style:italic">n</span>=101).<br>
- savoir utiliser l’identité de Bézout pour trouver l’inverse <span style="font-style:italic">u</span>
d’un élément de <span style="font-style:italic">n</span> de <span style="font-style:italic">Z</span>/101<span style="font-style:italic">Z</span> pour le codage linéaire (on a
<span style="font-style:italic">u</span>=<span style="font-family:monospace"><span style="font-style:italic">iegcd</span></span><span style="font-family:monospace">(</span><span style="font-family:monospace"><span style="font-style:italic">n</span></span><span style="font-family:monospace">,101)[0]</span> car <span style="font-style:italic">u</span>*<span style="font-style:italic">n</span>+<span style="font-style:italic">v</span>*101=1).
</li></ol>
<h3 id="sec345" class="subsection">12.6.3  Le programme Xcas</h3>
<pre class="verbatim">codec2n(c):={
if (c=="\'e") return 100;
if (c=="\`e") return 99;
if (c=="\`a") return 98;
if (c=="\c{c}") return 97;
if (c=="\`u") return 96;
if (c=="\^e") return 95;
return(asc(c)-32);
};

coden2c(k):={
if (k== 100) return "\'e";
if (k==99) return "\`e";
if (k==98) return "\`a";
if (k==97) return "\c{c}";
if (k==96) return "\`u";
if (k==95) return "\^e";
return(char(k+32));
};

jules_cesar(message,clef):={
local s,j,messcode;
s:=size(message);
messcode:="";
for (j:=0;j&lt;s;j++) {
messcode:=append(messcode,
                 coden2c(irem(clef+codec2n(message[j]),101)));
}
return (messcode);
};

lineaire(message,clef):={
local s,j,messcode;
s:=size(message);
messcode:="";
for (j:=0;j&lt;s;j++) {
messcode:=messcode+coden2c(irem(clef*codec2n(message[j]),101));
}
return (messcode);
};
</pre><p><span style="font-family:monospace">codec2n</span> transforme un caractère <span style="font-style:italic">c</span> "autorisé" en un entier <span style="font-style:italic">n</span>, 
0≤ <span style="font-style:italic">n</span> &lt;101 selon la table <a href="#sec%3Acode">12.6.1</a>.<br>
<span style="font-family:monospace">coden2c</span> transforme un entier <span style="font-style:italic">n</span>, 0≤ <span style="font-style:italic">n</span> &lt;101 
en un caractère <span style="font-style:italic">c</span> selon la table <a href="#sec%3Acode">12.6.1</a>.<br>
<span style="font-family:monospace">jules_cesar</span> (respectivement <span style="font-family:monospace">lineaire</span>) code le message selon la 
clé choisie. On remarquera que les deux fonctions ne diffèrent que par 
l’opération effectuée :<br>
<span style="font-family:monospace">clef+codec2n(message[j])</span> pour la fonction <span style="font-family:monospace">jules_cesar</span> et <br>
<span style="font-family:monospace">clef+codec2n(message[j])</span> pour la fonction <span style="font-family:monospace">lineaire</span>.<br>
Pour décoder, il suffit d’employer le même programme en utilisant la clef 
de décodage associée à la clef de codage et à la méthode utilisée :
par exemple, pour <span style="font-family:monospace">jules_cesar</span> de clef de codage 99 la clé 
de décodage associée est 2 (2+99=101=0 mod101) et <br>
pour <span style="font-family:monospace">lineaire</span> de clef de codage 99 la clef 
de décodage associée est 50 puisque 99*50=−2*50=−100=1 mod101.</p>
<h3 id="sec346" class="subsection">12.6.4  Le programme C++</h3>
<pre class="verbatim">//#include &lt;iostream&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;

//using namespace std;

int codec2n(char c){
  int i=c;
  switch (c){
  case  '\'e':
    i=100; 
    break;
  case '\`e':
    i=99;
    break;
  case '\`a':
    i=98;
    break;
  case '\c{c}':
    i=97;
    break;
  case '\`u':
    i=96;
    break;
  case '\^e':
    i=95;
    break;
  default:
    i -= 32;
  }
  return i;
}

char coden2c(int i){
  if (i&lt;95)
    return i+32;
  switch (i){
  case 95:
    return '\^e';
  case 96:
    return '\`u';
  case 97:
    return '\c{c}';
  case 98:
    return '\`a';
  case 99:
    return '\`e';
  case 100:
    return '\'e';
  }
}

int main(int argc,char ** argv){
  char * s=0,ch;
  size_t n=0;
  int i,d,fois;
  if (!strcmp(argv[0],"./table")){
    for (i=0;i&lt;101;++i){
      ch=coden2c(i);
      printf("%d:%c &amp;",i,ch);
      if (i%10==0)
 printf("\n");
    }
    return 0;
  }
  if (!strcmp(argv[0],"./coden2c")){
    for (i=1;i&lt;argc;++i){
      d=atoi(argv[i]);
      ch=coden2c(d);
      printf("%c",ch);
    }
    printf("\n");
    return 0;
  }
  if (argc==3)
    fois=atoi(argv[2]);
  else
    fois=0;
  if (argc&gt;=2){
    s=argv[1];
    n=strlen(s);
  }
  else {
    printf("Entrez un message \`a num\'eriser\n");
    getline(&amp;s,&amp;n,stdin);
    n=strlen(s)-1;
  }
  for (i=0;i&lt;n;++i){
    d=codec2n(s[i]);
    if (fois)
      printf("%c",coden2c(d*fois % 101));
    else
      printf("%d ",d);
  }
  printf("\n");
  return 0;
}
</pre>
<h3 id="sec347" class="subsection">12.6.5  Exercices de décodage</h3>
<h4 id="sec348" class="subsubsection">Avec le codage Jules César</h4>
<p><span style="font-size:x-large">message 1, codage Jules César clef 10<br>
</span><code><span style="font-size:x-large">\`uy\^e}*kvvo\'e*qkqxo|*\^ex*MN</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 2, codage Jules César clef 10<br>
</span><code><span style="font-size:x-large">vk*}yv\^e~syx*x1o}~*zk}*)\`usnox~o</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 3, codage Jules César clef 23<br>
</span><code><span style="font-size:x-large">(\`u(|7\`e|%7\`e!~\`uz\`u|\`e%7\`e\`uy$|%</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 4, codage Jules César clef 23<br>
</span><code><span style="font-size:x-large">$\`u| 7 |7%|$&amp;7{|7z!'$\`u$</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 5, codage Jules César clef 35<br>
</span><code><span style="font-size:x-large">\'e..#*-,1C3,C!&amp;\'e2C3,C!&amp;\'e2</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 6, codage Jules César clef 35<br>
</span><span style="font-size:x-large"><span style="font-family:monospace">*éC0B.-,1#C0#*A4#C"3C"B$’</span></span><span style="font-size:x-large">
<br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 7, codage Jules César clef 99<br>
</span><code><span style="font-size:x-large">f_`gjcr\`aq\`ea_jasj_rmgpcq\`em`jge_rmgpcq</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 8, codage Jules César clef 99<br>
</span><code><span style="font-size:x-large">gj\`ed_gr\`e`c_s\`ecr\`eaf_sb</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 9, codage Jules César clef 51<br>
</span><code><span style="font-size:x-large">:ZCB7:7A/B7=&lt;S23S13S1=2/53S3ABS27A1CB/0:3</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 10, codage Jules César clef 51<br>
</span><code><span style="font-size:x-large">&lt;=CASD=C:=&lt;ASRD7B3@S:/S1=&lt;4CA7=&lt;</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>

message 11, codage Jules César clef 45<br>
</span><code><span style="font-size:x-large">*-)=+7=8M,-M&lt;:)&gt;)14M87=:M:1-6</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 12, codage Jules César clef 45<br>
</span><code><span style="font-size:x-large">;+1-6+-M;)6;M+76;+1-6+-M6T-;&lt;M9=-M:=16-M,-M4T)5-</span></code><span style="font-size:x-large">
</span>
</p>
<h4 id="sec349" class="subsubsection">Avec le codage linéaire</h4>
<p>
<span style="font-size:x-large">message 1, codage linéaire clef 10<br>
</span><code><span style="font-size:x-large">TsJ6 LUUt| #L#it, Ji OY</span></code><span style="font-size:x-large">
<br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 2, codage linéaire clef 10<br>
</span><code><span style="font-size:x-large">UL 6sUJ@7si ift6@ }L6 {T7jti@t</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 3, codage linéaire clef 23<br>
</span><code><span style="font-size:x-large">[_[h ?h{ ?\'e1_:_h?{ ?_#dh{</span></code><span style="font-size:x-large">
<br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 4, codage linéaire clef 23<br>
</span><code><span style="font-size:x-large">d_hm mh {hd- Qh :\'eDd_d</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 5, codage linéaire clef 35<br>
</span><code><span style="font-size:x-large">Uii|BF#m N# 6\`uU+ N# 6\`uU+</span></code><span style="font-size:x-large">
<br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 6, codage linéaire clef 35<br>
</span><code><span style="font-size:x-large"> BU JbiF#m| J|B?q| YN Yb:&gt;</span></code><span style="font-size:x-large">
<br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 7, codage linéaire clef 99<br>
</span><code><span style="font-size:x-large">ZhfXR`B"D dhRd@RhBLXF`D LfRX\hBLXF`D</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 8, codage linéaire clef 99<br>
</span><code><span style="font-size:x-large">XR ^hXB f`h@ `B dZh@b</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 9, codage linéaire clef 51<br>
</span><code><span style="font-size:x-large">FV}JwFw|sJwzG Bu tu tzBsvu u|J Bw|t}JsAFu</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 10, codage linéaire clef 51<br>
</span><code><span style="font-size:x-large">Gz}| Kz}FzG| RKwJuI Fs tzGC}|wzG</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>

message 11, codage linéaire clef 45<br>
</span><code><span style="font-size:x-large">Ik\c{c}xv4xa &gt;k KV\c{c}@\c{c}Uw a4xV VUkl</span></code></p><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 12, codage linéaire clef 45<br>
</span><code><span style="font-size:x-large">\`evUklvk \`e\c{c}l\`e v4l\`evUklvk l,k\`eK )xk VxUlk &gt;k w,\c{c}?k</span></code><span style="font-size:x-large">
</span></p>
<h3 id="sec350" class="subsection">12.6.6  Solutions des exercices de décodage Jules César et linéaire</h3>
<p>
1: vous allez gagner un CD<br>
2: la solution n’est pas évidente<br>
3: vive les logiciels libres<br>
4: rien ne sert de courir<br>
5: appelons un chat un chat<br>
6: la réponse relève du défi<br>
7: habiletés calculatoires obligatoires<br>
8: il fait beau et chaud<br>
9: l’utilisation de ce codage est discutable<br>
10: nous voulons éviter la confusion<br>
11: beaucoup de travail pour rien<br>
12: science sans conscience n’est que ruine de l’ame<br>

</p>
<h2 id="sec351" class="section">12.7  Chiffrement affine : premier algorithme</h2>
<p><a id="sec:bijection"></a>
</p>
<h3 id="sec352" class="subsection">12.7.1  L’algorithme</h3>
<p><a id="subsec:bijection"></a>
Pour écrire le message on ne se restreint plus aux 26 lettres de l’alphabet. 
On suppose que le message à coder n’utilise que les caractères dont le code
ASCII va de 32 à 127 (avant 32, les caractères ne sont pas imprimables, et
après 127 il s’agit de caractères spéciaux...).<br>
On choisit dans ce premier algorithme de coder chaque lettre : cela à 
l’incovénient de décrypter facilement le message en analysant la 
fréquence des lettres du message crypté, c’est pourquoi dans le deuxième 
algorithme, on code des groupements de trois lettres.<br>
Il y a alors trois choses à faire qui sont les trois instructions de la 
fonction <span style="font-family:monospace">cod1</span> et qui code un caractère par un autre caractère :<br>
- on transforme chaque caractère en un entier <span style="font-style:italic">n</span> de 0 à 95 (en enlevant 32
à son code ASCII)<br>
- puis, on applique à cet entier <span style="font-style:italic">n</span> le chiffrement affine :</p><p> <span style="font-style:italic">f</span>(<span style="font-style:italic">n</span>)=<span style="font-style:italic">a</span> × <span style="font-style:italic">n</span>+<span style="font-style:italic">b</span> (mod 96) avec <span style="font-style:italic">f</span>(<span style="font-style:italic">n</span>) ∈[0..95].<br>
Pour que cette application soit bijective il faut et il suffit que <span style="font-style:italic">a</span> soit 
premier avec 96. En effet d’après l’identité de Bézout il
existe <span style="font-style:italic">u</span> et <span style="font-style:italic">v</span> tels que :<br>
<span style="font-style:italic">a</span> × <span style="font-style:italic">u</span>+96 × <span style="font-style:italic">v</span>=1 donc <span style="font-style:italic">a</span> × <span style="font-style:italic">u</span>=1 (mod 96)).<br>
On a donc <span style="font-style:italic">f</span><sup>−1</sup>(<span style="font-style:italic">m</span>)=<span style="font-style:italic">u</span>.(<span style="font-style:italic">m</span>−<span style="font-style:italic">b</span>) (mod96)<br>
- on transforme le nombre trouvé <span style="font-style:italic">f</span>(<span style="font-style:italic">n</span>) en un caractère de code <span style="font-style:italic">f</span>(<span style="font-style:italic">n</span>)+32.<br>
 Pour coder le message, il suffit ensuite de coder chaque caractère, 
c’est ce que fait la fonction <span style="font-family:monospace">codm1</span>.<br>

Pour décoder, il suffit de remplacer la valeur de <span style="font-style:italic">a</span> par 
<span style="font-style:italic">a</span>1=<span style="font-style:italic">u</span> (mod 96) si <span style="font-style:italic">a</span> × <span style="font-style:italic">u</span>+96 × <span style="font-style:italic">v</span>=1 <br>
et la valeur de <span style="font-style:italic">b</span> par <span style="font-style:italic">b</span>1=−<span style="font-style:italic">a</span>1 × <span style="font-style:italic">b</span> (mod 96)<br>
car alors on a <span style="font-style:italic">n</span>=<span style="font-style:italic">a</span>1 × <span style="font-style:italic">f</span>(<span style="font-style:italic">n</span>)+<span style="font-style:italic">b</span>1 (mod 96) <br>
Les fonctions de décodage et de codage sont donc les mêmes , seuls les 
paramètres sont différents!<br>
<span style="font-weight:bold">Exemple</span><br>
<span style="font-style:italic">a</span>=85 <span style="font-style:italic">b</span>=2 <br>
On a par l’identité de Bézout :<br>
 85 × 61 − 96 × 54 = 1
et
 −2 × 61 = −122 = 70 (mod 96)<br>
donc on obtient :<br>
<span style="font-style:italic">a</span>1=61 <span style="font-style:italic">b</span>1=70
</p>
<h3 id="sec353" class="subsection">12.7.2  Traduction Algorithmique</h3>
<p>
On note <span style="font-family:monospace">char</span> la fonction qui à un nombre <span style="font-family:monospace">n</span> associe 
le caractère de code ASCII <span style="font-family:monospace">n</span> et <span style="font-family:monospace">asc</span> la fonction qui à un caractère associe son code ASCII.<br>
Voici le codage d’une lettre <span style="font-family:monospace">c</span> par la fonction cod1 (<span style="font-family:monospace">a,b</span> sont les 
paramètres du chiffrement affine) :<br>
<span style="font-family:monospace">fonction cod1(c,a,b)<br>
local n <br>
asc(c)-32 =&gt; n<br>
a.n+b mod 96 =&gt; n<br>
résultat char(n+32)<br>
ffonction</span><br>

On suppose que l’on a accés au <span style="font-family:monospace">k</span>-ième caractère du mot <span style="font-family:monospace">m</span> en 
mettant <span style="font-family:monospace">m[k]</span>.<br>
On suppose que la concaténation de deux mots se fait avec <span style="font-family:monospace">concat</span>.<br>
Voici le codage du message <span style="font-family:monospace">m</span> par la fonction coda1 (<span style="font-family:monospace">a,b</span> sont les 
paramètres du chiffrement affine) : <br>
<span style="font-family:monospace">fonction codm1(m,a,b)<br>
local r,k,n <br>
"" =&gt;r<br>
k=&gt;0
longueur_mot(m)=&gt;s
tantque k&lt;s<br>
m[k]=&gt;c<br>
k+1=&gt;k<br>
concat(r,cod1(c,a,b))=&gt;r<br>
ftantque<br>
retourne r<br>
ffonction</span><br>
</p>
<h3 id="sec354" class="subsection">12.7.3  Traduction Xcas</h3>
<p>
On dispose de :<br>
- <span style="font-family:monospace">char</span> la fonction qui à un nombre <span style="font-family:monospace">n</span> associe le caractère de
code ASCII <span style="font-family:monospace">n</span> et, qui a une liste de nombres associe la chaîne des 
caractères dont les codes correspondent aux nombres de la liste.<br>
- <span style="font-family:monospace">asc</span> la fonction qui à une chaîne de caractères 
associe la liste des codes ASCII des caractères composant la chaîne.<br>
<span style="font-weight:bold">Attention</span> <span style="font-family:monospace">asc("A")=[65]</span> et donc <span style="font-family:monospace">(asc("A"))[0]=65</span>.</p><p>Voici le codage d’une lettre par la fonction cod1 :
</p><pre class="verbatim">cod1(c,a,b):={
local n;
n:=(asc(c))[0]-32;
n:=irem(a*n+b,96);
return(char(n+32));
}
</pre><p>Voici le codage du message par la fonction codm1 :
</p><pre class="verbatim">codm1(m,a,b):={
local r,c,s;
r:="";
s:=size(m);
for (k:=0;k&lt;s;k++){
c:=m[k];
r:=concat(r,cod1(c,a,b));
}
return(r);
}
</pre><p>
On peut aussi coder directement le message <span style="font-family:monospace">mess</span> : en effet avec 
<span style="font-family:monospace">Xcas</span> les fonctions <span style="font-family:monospace">asc</span>
et <span style="font-family:monospace">char</span> gérent les chaînes et les listes.<br>
On transforme donc le message (i.e une chaîne de caractères)
en une liste <span style="font-family:monospace">l</span> de nombres avec <span style="font-family:monospace">asc(mess)</span>, puis on transforme cette 
liste de nombres par l’application
affine  <span style="font-style:italic">f</span>(<span style="font-style:italic">n</span>)=<span style="font-style:italic">a</span> × <span style="font-style:italic">n</span>+<span style="font-style:italic">b</span> (mod 96) en la liste <span style="font-family:monospace">mc</span>, puis on 
transformer la liste <span style="font-family:monospace">lc</span>
des nombres ainsi obtenus en une chaîne de caractères 
(avec <span style="font-family:monospace">char(lc)</span>, c’est ce que fait la fonction <span style="font-family:monospace">codm</span>).<br>
Dans ce qui suit on a écrit les fonctions :<br>
<span style="font-family:monospace">bonpara(para)</span> (avec <span style="font-family:monospace">para=[a,b]</span>) renvoie la liste des paramètres 
de décodage si le paramètre <span style="font-family:monospace">a</span> est premier avec 96. 
Cette fonction utilise la fonction <span style="font-family:monospace">decopara(para)</span> qui calcule les paramètres de décodage. 
</p><pre class="verbatim">decopara(para):={
//decopara permet de trouver les parametres de decodage
local bez,a,b;
a:=para[0];
b:=para[1];
bez:=bezout(a,96);
a:=irem(bez[0],96);
if (a&lt;0) a:=a+96;
b:=irem(-b*a,96);
if (b&lt;0) b:=b+96;
return([a,b]);
};
bonpara(para):={
//teste si a est premier avec 96
if (pgcd(para[0],96)==1) return(decopara(para)); else return(false);
};
codm(mess,para):={
//codage par chiffrement affine de parametres para=[a,b] mod 96
//codm code le message mess (="....") avec para=[a,b]
local l,lc,sl,a,b,c;
a:=para[0];
b:=para[1];
l:=asc(mess);
sl:=size(l);
for (k:=0;k&lt;sl;k++){
//les caracteres codes entre 0 et 31 ne sont pas lisibles
l[k]:=l[k]-32;
}
lc:=[];
for (j:=0;j&lt;sl;j++){
c:=irem(a*l[j]+b,96);
lc:=concat(lc,32+c);
}
return(char(lc));
}
</pre>
<h2 id="sec355" class="section">12.8  Chiffrement affine : deuxième algorithme</h2>
<h3 id="sec356" class="subsection">12.8.1  L’algorithme</h3>
<p>
On peut aussi choisir de coder le message en le découpant par paquets de 3
lettres que l’on appelle mot et en rajoutant, éventuellement, des espaces à la fin du message 
pour que le nombre de caractères du message soit un multiple de 3.<br>
Comme précédemment, à chaque caractère on fait correspondre un nombre entier
de l’intervalle [0..95].<br>
 On considére alors un mot de 3 lettres comme l’écriture dans la base 96 d’un nombre entier <span style="font-style:italic">n</span> :<br>
<span style="font-weight:bold">Exemple</span><br>
le mot <span style="font-family:monospace">BAL</span> est la représentation de <span style="font-style:italic">n</span>=34 × 96<sup>2</sup>+33 × 96+44=316556.<br>
En effet <span style="font-family:monospace">B</span> est codé par 34 puisque son code ASCII est 66 (66-32=34),
<span style="font-family:monospace">A</span> est codé par 33 et <span style="font-family:monospace">L</span> est codé par 44.<br>
On code les mots de 3 lettres par un autre mot, puis on en déduit le 
codage du message tout entier.
Le programme <span style="font-family:monospace">mot2n</span> transforme un mot <span style="font-style:italic">m</span> de 3 lettres en un nombre entier
<span style="font-style:italic">n</span> dont l’écriture en base 96 est <span style="font-style:italic">m</span>. On a donc, si <span style="font-style:italic">m</span> a 3 lettres 
<span style="font-style:italic">n</span>&lt;96<sup>3</sup>.<br>
Par exemple <span style="font-family:monospace">mot2n("BAL")=316559</span>. </p><p>Le progamme <span style="font-family:monospace">codaff</span> transforme <span style="font-style:italic">n</span> selon le chiffrement affine :<br>
 <span style="font-style:italic">f</span>(<span style="font-style:italic">n</span>)=<span style="font-style:italic">a</span> × <span style="font-style:italic">n</span>+<span style="font-style:italic">b</span>  mod <span style="font-style:italic">p</span> .<br>
- il faut choisir <span style="font-style:italic">p</span> ≥ 96<sup>3</sup> ; si <span style="font-style:italic">p</span>&gt;96<sup>3</sup>, le nombre (<span style="font-style:italic">f</span>(<span style="font-style:italic">n</span>)) obtenu 
aprés transformation affine de <span style="font-style:italic">n</span>, peut avoir une représentation de 
plus de 3 lettres dans la base 96.
Mais, au décodage tous les mots auront exactement 3 lettres.
Pour les calculateurs qui limitent la représentation d’un entier à 12 
chiffres il faut choisir <span style="font-style:italic">p</span> ≤ 10<sup>6</sup> pour que <span style="font-style:italic">a</span> × <span style="font-style:italic">n</span> +<span style="font-style:italic">b</span> &lt; 10<sup>12</sup><br>
- pour que <span style="font-style:italic">f</span> soit inversible il faut que <span style="font-style:italic">a</span> et <span style="font-style:italic">p</span> soient premiers entre eux
(cf p <a href="#sec%3Abijection">??</a>) .</p><p><span style="font-weight:bold">Exemple</span><br>
<span style="font-style:italic">a</span>=567 <span style="font-style:italic">b</span>=2 <span style="font-style:italic">p</span>=10<sup>6</sup></p><p>On obtient par Bézout :</p><p>567 × 664903 +10<sup>6</sup> × 377 =1</p><p>et  −2 × 664903 = 670164  mod 10<sup>6</sup></p><p>donc <span style="font-style:italic">a</span>1=664903 et <span style="font-style:italic">b</span>1=670164</p><p>Le programme <span style="font-family:monospace">n2mot</span> fait l’opération inverse et transforme un nombre 
entier <span style="font-style:italic">n</span> en un mot <span style="font-style:italic">m</span> (d’au moins 3 symboles) qui est la représentation 
de <span style="font-style:italic">n</span> dans la base 96.<br>
Il faut faire attention aux espaces en début de mot!!! En effet, l’espace 
est codé par <span style="font-family:monospace">0</span> et il risque de disparaître si on ne fait pas 
attention, au décodage!!!<br>
Exemple<br>
On a <span style="font-family:monospace"><span style="font-style:italic">n</span></span><span style="font-family:monospace">2</span><span style="font-family:monospace"><span style="font-style:italic">mot</span></span><span style="font-family:monospace">(34)="   </span><span style="font-family:monospace"><span style="font-style:italic">B</span></span><span style="font-family:monospace">"</span> (c’est à dire la chaîne formée par 2 espaces et B).<br>
Le programme <span style="font-family:monospace">codmot3</span> code les mots d’au moins 3 lettres en un mot d’au moins 3 
lettres à l’aide du chiffrement affine. En changeant les paramètres <span style="font-style:italic">a</span> et <span style="font-style:italic">b</span>
<span style="font-family:monospace">codmot3</span> décode les mots codés avec <span style="font-family:monospace">codmot3</span>.</p><p>Le programme <span style="font-family:monospace">codmess3</span> code les messages à l’aide du chiffrement affine.
Pour décoder, il suffit d’utiliser la fonction <span style="font-family:monospace">codmess3</span> en changeant les paramètres <span style="font-style:italic">a</span> et <span style="font-style:italic">b</span>. 
</p>
<h3 id="sec357" class="subsection">12.8.2  Traduction Algorithmique</h3>
<p>
Voici la transformation d’un mot <span style="font-family:monospace">m</span> en un nombre
entier <span style="font-family:monospace">n</span> par la fonction <span style="font-family:monospace">mot2n</span> :<br>
<span style="font-family:monospace">fonction mot2n(mo)<br>
local k,p,n<br>
0=&gt;n<br>
0=&gt;k<br>
tantque k&lt;longueur_mot(mo) </span>≠<span style="font-family:monospace"> ""<br>
asc(mo[k])-32=&gt;p<br>
k+1=&gt;k<br>
n*96+p=&gt;n<br>
ftantque<br>
retourne n<br>
ffonction</span><br>
Voici la transformation d’un nombre entier <span style="font-family:monospace">n</span> en son écriture en base 96 
(c’est à dire en un mot <span style="font-family:monospace">m</span> d’au moins 3 lettres) par la fonction 
<span style="font-family:monospace">n2mot</span> :<br>
<span style="font-family:monospace">fonction n2mot(n)<br>
local m,r,j<br>
""=&gt;m<br>
0=&gt;j<br>
tantque n &gt;0 ou j&lt; 3<br>
char((n mod 96)+32)=&gt;r<br>
int(n/96)=&gt;n<br>
r+m=&gt;m<br>
j+1=&gt;j<br>
ftantque<br>
retourne m<br>
ffonction</span><br>
Voici le codage d’un mot d’au moins 3 lettres par la fonction <span style="font-family:monospace">codmot3</span> :<br>
<span style="font-family:monospace">fonction codmot3(m,a,b,p)<br>
local n<br>
mot2n(m)=&gt;n<br>
a.n+b mod p =&gt;n<br>
n2mot(n)=&gt;m<br>
retourne m<br>
ffonction</span><br>
Voici le codage d’un message par la fonction <span style="font-family:monospace">codmess</span> :<br>
<span style="font-family:monospace">fonction codmess3(m,a,b,p)<br>
local n,i,r,d<br>
int(dim(m)/3)+1=&gt;n<br>
{}=&gt;r<br>
1=&gt;i<br>
tantque i&lt;n<br>
debut(m,3)=&gt;d<br>
fin(m,4)=&gt;m<br>
codmot3(d,a,b,p)=&gt;r[i]<br>
i+1=&gt;i<br>
ftantque<br>
si dim(m)=2 alors<br>
m + " "=&gt;m<br>
codmot3(m,a,b,p)=&gt;r[i]<br>
sinon<br>
si dim(m)=1 alors<br>
m + " " =&gt;m<br>
codmot3(m,a,b,p)=&gt;r[i]<br>
sinon<br>
fin(r,i-1)=&gt;r<br>
fsi<br>
fsi<br>
retourne r<br>
ffonction</span></p>
<h3 id="sec358" class="subsection">12.8.3  Traduction Xcas</h3>
<p>
Voici la fonction <span style="font-family:monospace">decopara3(para)</span> qui donne les paramètres de décodage
quand les paramètres sont corrects.<br>
On prend comme chiffrement affine  <span style="font-style:italic">a</span>*<span style="font-style:italic">n</span>+<span style="font-style:italic">b</span> mod 96<sup>3</sup> car on veut mettre le message codé dans une chaîne et donc transformer un paquet 
de 3 lettres en un paquet d’exactement 3 lettres.
</p><pre class="verbatim">decopara3(para):={
//=le parametrage de decodage du parametrage para (liste).
local a,b,l;
a:=para[0];
b:=para[1];
l:=bezout(a,96^3);
if (l[2]!=1) return(false);
a:=l[0];
if (a&lt;0) a:=a+96^3;
b:=-irem(b*a,96^3)+96^3;
return([a,b]);
}
</pre><p>
Voici la transformation d’un mot <span style="font-style:italic">s</span> d’au moins 3 lettres en un nombre entier 
par la fonction <span style="font-family:monospace">mot2n</span> :
</p><pre class="verbatim">mot2n(s):={
//transforme un mot s de 3 lettres en n 
//n a pour ecriture s en base 96 
local l,n;
l:=asc(s);
n:=(l[0]-32)*96^2+(l[1]-32)*96+l[2]-32;
return(n);
}
</pre><p>Voici la transformation d’un nombre entier <span style="font-style:italic">n</span> en son écriture en base 96 
(c’est à dire en un mot d’au moins 3 lettres) par la fonction <span style="font-family:monospace">n2mot</span> :
cette fonction utilise la fonction <span style="font-family:monospace">ecritu96</span> qui écrit <span style="font-family:monospace">n</span> dans la
base 96 comme un mot de 1,2,3 etc caractères. Pour obtenir un mot d’au moins 3 lettres il suffit de rajouter des espaces devant le mot puisque le code 
ASCII de l’espace vaut 32, cela revient à rajouter des zéros devant l’écriture de <span style="font-family:monospace">n</span>. 
</p><pre class="verbatim">ecritu96(n):={
//transforme l'entier n en la chaine s
//s est l'ecriture de n en base 96
local s,r;
// n est un entier et b=96
// ecritu96 est une fonction iterative 
//ecritu96(n)=l'ecriture de n en base 96 
s:="";
while (n&gt;=96){
r:=irem(n,96);
r:=char(r+32);
s:=r+s;
n:=iquo(n,96);
}
n:=char(n+32);
s:=n+s;
return(s);
};

n2mot(n):={
local mot,s;
mot:=ecritu96(n);
s:=size(mot);
//on suppose n&lt;96^3 on transforme n en un mot de 3 caracteres
//on rajoute des espaces si le mot n'a pas 3 lettres
if (s==2) {mot:=" "+mot;}
else {
if (s==1) {mot:="  "+mot;}
}
return(mot); 
}
</pre><p>Voici le codage d’un mot d’au moins 3 lettres par la fonction codmot3 : en prenant toujours <span style="font-family:monospace"><span style="font-style:italic">p</span></span><span style="font-family:monospace">=96</span><sup><span style="font-family:monospace">3</span></sup>
</p><pre class="verbatim">codmot3(mot,para):={
//codage d'un mot de 3 lettres avec le parametrage para=[a,b]
local n,m,a,b;
//para:[569,2] mod 96^3
//decopara3=[674825, 419822]
a:=para[0];
b:=para[1];
n:=mot2n(mot);
m:=irem(a*n+b,96^3);
return(n2mot(m));
}
</pre><p>
Le décodage d’un mot codé avec <span style="font-family:monospace">codmot3</span> se fait aussi avec la fonction 
<span style="font-family:monospace">codmot3</span>.<br>
Voici le codage d’un message par la fonction <span style="font-family:monospace">codmess3</span> :
</p><pre class="verbatim">codmess3(mess,para):={
//code le message mess,parametrage para et paquet de 3 lettres 
  local s,messcod,mess3;
  s:=size(mess);
  if (irem(s,3)==2){ 
    mess:=mess+" ";
    s:=s+1;
  }
  else {
    if (irem(s,3)==1) { 
       mess:=mess+"  ";
       s:=s+2;
    }
  } 
  messcod:="";
  for (k:=0;k&lt;s;k:=k+3){
    mess3:=mess[k..k+2];
    mess3:=codmot3(mess3,para);
    messcod:=messcod+mess3;
  }
return(messcod);
}
</pre><p>
Le décodage du message se fait aussi par la fonction <span style="font-family:monospace">codmess3</span>
</p>
<h2 id="sec359" class="section">12.9  Devoir à la maison</h2>
<p><a id="sec:dev"></a>
On écrit un message plus ou moins long selon le nombre d’élèves de la classe.
Puis on le partage en groupement de 8 lettres.<br>
Chaque groupe de 8 lettres est ensuite codé (lettre par lettre) à l’aide d’un chiffrement affine 
de paramètres diffèrents selon les élèves.</p><p>Le chiffrement affine lettre à lettre est déterminé par la donnée de 3 paramètres :<br>
<span style="font-style:italic">a</span>,<span style="font-style:italic">b</span>,<span style="font-style:italic">p</span> qui transforme l’entier <span style="font-style:italic">n</span> en <span style="font-style:italic">m</span>=<span style="font-style:italic">a</span>*<span style="font-style:italic">n</span>+<span style="font-style:italic">b</span> (mod <span style="font-style:italic">p</span>).<br>
Pour avoir une fonction de décodage il faut et il suffit que <span style="font-style:italic">a</span> soit inversible
dans <span style="font-style:italic">Z</span>/<span style="font-style:italic">pZ</span> c’est à dire que <span style="font-style:italic">a</span> et <span style="font-style:italic">p</span> soient premiers entre eux.<br>
La fonction de décodage est alors :<br>
 <span style="font-style:italic">a</span><sub>1</sub>*<span style="font-style:italic">m</span>+<span style="font-style:italic">b</span><sub>1</sub> avec,<br>
<span style="font-style:italic">a</span><sub>1</sub> inverse de <span style="font-style:italic">a</span>  dans <span style="font-style:italic">Z</span>/<span style="font-style:italic">pZ</span> (<span style="font-style:italic">a</span><sub>1</sub>=<span style="font-style:italic">u</span> (mod <span style="font-style:italic">p</span>) si <span style="font-style:italic">a</span>*<span style="font-style:italic">u</span>+<span style="font-style:italic">p</span>*<span style="font-style:italic">v</span>=1 
(identité de Bézout)) et <span style="font-style:italic">b</span><sub>1</sub>=−<span style="font-style:italic">b</span>*<span style="font-style:italic">a</span><sub>1</sub> (mod <span style="font-style:italic">p</span>).<br>

Pour ce chiffrement affine, on peut utiliser tous les caractères dont les codes
ASCII vont de 32 à 127 (les caractères de code 0 à 31 ne sont pas imprimables
et au delà de 127 ils ne sont pas standards).<br>

Étant donnés <span style="font-style:italic">a</span>, <span style="font-style:italic">b</span>, <span style="font-style:italic">p</span>=96, comment coder ?<br>
À chaque caractère (de code ASCII compris entre 32 et 127) on fait 
correspondre un entier <span style="font-style:italic">n</span> entre 0 et 95 ; 
<span style="font-style:italic">n</span> est égal à : (code ASCII du caractère) - 32.<br>
Par exemple, à <span style="font-family:monospace">B</span> on fait correspondre 34 (66-32 ).<br>
Puis, on calcule <span style="font-style:italic">m</span>=<span style="font-style:italic">a</span>*<span style="font-style:italic">n</span>+<span style="font-style:italic">b</span>  mod 96 :<br>
pour <span style="font-style:italic">a</span>=55, <span style="font-style:italic">b</span>=79 et <span style="font-style:italic">n</span>=34 on obtient <span style="font-style:italic">m</span>=29.<br>
Puis, on cherche le caractère de code ASCII <span style="font-style:italic">m</span>+32. Le caractère qui a
comme code ASCII 29+32=61 est le signe <span style="font-family:monospace">=</span>) : c’est ce caractère qui 
sera donc choisi comme codage de la lettre <span style="font-family:monospace">B</span>.<br>
<span style="font-weight:bold">Exemple :</span><br>
On va coder la phrase :<br>
<span style="font-family:monospace">BEAUCOUP DE TRAVAIL POUR RIEN!?</span><br>
en la coupant en trois morceaux (le caractère espace termine les deux premiers morceaux). <br>
Par exemple :<br>
<span style="font-family:monospace">BEAUCOUP </span> sera codé avec <span style="font-style:italic">a</span>=55 <span style="font-style:italic">b</span>=79 et <span style="font-style:italic">p</span>=96<br>
<span style="font-family:monospace">DE TRAVAIL </span> sera codé avec <span style="font-style:italic">a</span>=49 <span style="font-style:italic">b</span>=25 et <span style="font-style:italic">p</span>=96<br>
<span style="font-family:monospace">POUR RIEN!?</span> sera codé avec <span style="font-style:italic">a</span>=73 <span style="font-style:italic">b</span>=48 et <span style="font-style:italic">p</span>=96<br>
On code <span style="font-family:monospace">BEAUCOUP </span> avec <span style="font-style:italic">a</span>=55 <span style="font-style:italic">b</span>=79 et <span style="font-style:italic">p</span>=96.<br>
 On obtient :<br>
<span style="font-family:monospace">="f2th2?o</span><br>
Le devoir du premier élève est donc :<br>
avec les paramètres de codage <span style="font-style:italic">a</span>=55  <span style="font-style:italic">b</span>=79 et <span style="font-style:italic">p</span>=96, décoder <span style="font-family:monospace">="f2th2?o</span><br>
L’élève doit :<br>
 - trouver les paramètres de décodage (ici <span style="font-style:italic">a</span><sub>1</sub>=7  <span style="font-style:italic">b</span><sub>1</sub>=23) :<br>
en effet l’inverse <span style="font-style:italic">a</span><sub>1</sub> de <span style="font-style:italic">a</span> (mod96) est obtenu en ecrivant l’identité de Bézout pour <span style="font-style:italic">a</span> et <span style="font-style:italic">p</span> :<br>
55*7−96*4=1 et <span style="font-style:italic">b</span><sub>1</sub>=79*7  (mod 96) = 23<br>
 - puis décoder à l’aide d’une table de code ASCII :<br>
le code ASCII du caractère <span style="font-family:monospace">  = </span> est 61 donc :<br>
<span style="font-style:italic">m</span>=61−32=29<br>
<span style="font-style:italic">a</span><sub>1</sub>*<span style="font-style:italic">n</span>+<span style="font-style:italic">b</span><sub>1</sub> (mod 96) = 7*29+23  (mod 96) = 226 (mod 96) = 34<br>
La lettre de code 34+32 = 66 est <span style="font-family:monospace">B</span><br>
</p>
<h3 id="sec360" class="subsection">12.9.1  Le code Ascii</h3>
<p> 
Voici pour <span style="font-family:monospace">Xcas</span>, la table des codes ASCII compris entre 30 
et 127. <br>

</p><table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >0</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >1</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >2</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >3</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >4</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >5</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >6</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >7</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >8</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >9 </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >30</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >_</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >!</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >"</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >#</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >$</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >%</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&amp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >’ </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >40</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >(</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >)</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >*</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >+</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >,</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >-</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >.</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >/</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >0</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >1 </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >50</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >2</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >3</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >4</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >5</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >6</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >7</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >8</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >9</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >:</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >; </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >60</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&lt;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >=</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&gt;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >?</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >@</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >A</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >B</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >C</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >D</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >E </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >70</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >F</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >G</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >H</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >I</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >J</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >K</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >L</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >M</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >N</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >O </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >80</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >P</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >Q</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >R</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >S</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >T</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >U</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >V</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >W</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >X</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >Y </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >90</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >Z</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >[</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >\</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >]</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >_</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >‘</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >a</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >b</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >c </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >100</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >d</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >e</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >f</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >g</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >h</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >i</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >j</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >k</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >l</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >m </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >110</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >n</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >o</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >p</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >q</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >r</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >s</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >t</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >u</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >v</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >w </td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >120</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >x</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >y</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >z</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >{</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >|</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >}</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >?</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td></tr>
<tr><td style="text-align:right;border:solid 1px;white-space:nowrap" >130</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td><td style="text-align:right;border:solid 1px;white-space:nowrap" >&nbsp;</td></tr>
</table>
<h2 id="sec361" class="section">12.10  Codage de Vigenère</h2>
<h3 id="sec362" class="subsection">12.10.1  Le principe du codage</h3>
<p>
On veut coder un message <span style="font-family:monospace">mess</span> qui n’utilise que les 26 lettres majuscules 
de l’alphabet.<br>
Dans le codage de César à chaque caractère correspond toujours le même 
caractère : c’est une fonction qui à une lettre de l’alphabet fait 
correspondre une lettre de l’alphabet.<br>
Dans le codage de Vigenère à un caractère <span style="font-style:italic">cara</span> du message correspond un 
caractère qui dépend de la position du caractère <span style="font-style:italic">cara</span> dans 
le message : c’est une fonction <span style="font-style:italic">f</span> de 2 variables qui à un entier <span style="font-style:italic">n</span> 
(0≤ <span style="font-style:italic">n</span>≤ 25) et et à une lettre de l’alphabet fait correspondre une 
lettre de l’alphabet. Cette correspondance se fait à l’aide d’une matrice 
carrée symétrique de dimension 26 appelée : carré de Vigenère.
</p>
<h3 id="sec363" class="subsection">12.10.2  Le carré de Vigenère</h3>
<p>
On a <span style="font-family:monospace">asc("A")=65</span>. Si le rang de <span style="font-family:monospace">"A"</span> dans la liste alphabétique 
est <span style="font-family:monospace">0</span> alors le rang d’une lettre <span style="font-family:monospace">c</span> dans la liste alphabétique 
est : <span style="font-family:monospace">op(asc(cara))-65</span>. Il faut utiliser la commande <span style="font-family:monospace">op</span> pour 
transformer la liste de dimension 1 renvoyée par <span style="font-family:monospace">asc</span> en un nombre.<br>
Si à une lettre on fait correspondre son rang dans la liste alphabétique, 
au carré de Vigenère on peut faire correspondre la matrice carrèe de 
dimension 26 :<br>
<span style="font-family:monospace">A[j,k]:=irem(j+k, 26)</span> pour <span style="font-family:monospace">j=0..25</span> et <span style="font-family:monospace">k=0..25</span>.<br>
Réciproquement si à un entier <span style="font-family:monospace">j</span> de l’intervalle 0..25] on fait 
correspondre la lettre de rang <span style="font-family:monospace">j</span> dans la liste alphabétique, alors,
à la matrice la matrice carrèe de dimension 26 <span style="font-family:monospace">A[j,k]:=irem(j+k, 26)</span> 
on fait correspondre le carré de Vigenère.<br>
On tape pour obtenir le carré de Vigenère <span style="font-family:monospace">CV</span> :<br>
<span style="font-family:monospace">CV:=makemat((j,k)-&gt;char(65+irem(j+k,26)),26,26)</span><br>
On tape pour obtenir la fonction <span style="font-family:monospace">f</span> de codage :<br>
<span style="font-family:monospace">f(n,cara):=CV[n,op(asc(cara))-65]</span><br>

<span style="font-weight:bold">Propriétés</span>
La matrice <span style="font-family:monospace">A[j,k]:=irem(j+k, 26)</span> est symétrique donc le carré de 
Vigenère est symétrique.<br>
Si connaissant <span style="font-family:monospace">j</span> et <span style="font-family:monospace">r</span>, on cherche <span style="font-family:monospace">k</span> pour que <span style="font-family:monospace">r=A[j,k]</span>, 
alors on a <span style="font-family:monospace">k=A[26-j,r]=A[r,26-j]</span>.<br>
En effet, <span style="font-family:monospace">r=irem(j+k,26)</span> donc <span style="font-family:monospace">k=irem(r-j,26)=irem(r+26-j,26</span>.<br>
Donc si <span style="font-family:monospace">r=A[j,k]</span> alors <span style="font-family:monospace">k=A[26-j,r]=A[r,26-j]</span>.<br>

On peut utiliser le tableau à double entrées ci-dessous pour coder à la 
main :<br>
</p><table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >&nbsp;</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >0</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >1</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >2</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >3</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >4</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >5</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >6</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >7</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >8</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >9</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >10</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >11</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >12</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >13</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >14</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >15</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >16</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >17</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >18</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >19</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >20</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >21</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >22</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >23</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >24</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >25</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td></tr>
</table><p><br>
Si à une lettre on fait correspondre son rang dans la liste alphabétique, 
au carré de Vigenère on peut faire correspondre la matrice :<br>
<span style="font-family:monospace">A[j,k]:=irem(j+k, 26)</span>.<br>
Ce carré donne la valeur de la fonction <span style="font-family:monospace">f</span> du codage qui est :
<span style="font-family:monospace">f(0,"D")="D"</span> (ligne 0 et colonne 3) et <span style="font-family:monospace">f(2,"D")="F"</span> (ligne 2 et 
colonne 3) pour coder par exemple les <span style="font-family:monospace">"D"</span> de <span style="font-family:monospace">"DINDON"</span> (Attention 
les indices commencent à 0). <br>
Ainsi <span style="font-family:monospace">"BONJOUR"</span> sera codé par :<br>
<span style="font-family:monospace">f("B",0)+f("O",1)+f("N",2)+f("J",3)+f("O",4)+f("U",5)+f("R",6)</span> <br>
c’est à dire <span style="font-family:monospace">"BPPMSZX"</span>
On pourra voir le programme qui code, décode avec ou sans clé en
<a href="#sec%3Acoddecod">12.10.10</a>.
</p>
<h3 id="sec364" class="subsection">12.10.3  Le programme du codage lettre par lettre</h3>
<p>
On utilise <span style="font-family:monospace">CV</span> dans le programme.<br>
On veut coder la lettre <span style="font-family:monospace">c</span> qui est d’indice <span style="font-family:monospace">j</span> dans le message.
Cette lettre <span style="font-family:monospace">c</span> est de rang <span style="font-family:monospace">op(asc(c))-65</span> dans l’alphabet.<br>
Il faut donc chercher dans le tableau <span style="font-family:monospace">CV</span> la lettre d’indice ligne 
<span style="font-family:monospace">irem(j,26)</span> et d’indice colonne <span style="font-family:monospace">op(asc(c))-65</span>.<br>
Par exemple si on cherche à coder <span style="font-family:monospace">"O"</span> d’indice 4 du message (la 5ième lettre du message à coder).<br>
<span style="font-family:monospace">"O"</span> a comme rang <span style="font-family:monospace">op(asc("O"))-65=14</span> dans l’alphabet (<span style="font-family:monospace">"O"</span> 
est la 15ième lettre de l’alphabet).<br>
Le codage est donc la lettre située dans la ligne d’indice <span style="font-family:monospace">irem(4,26)=4</span> 
(ligne débutant par <span style="font-family:monospace">"E"</span>) et dans la colonne <span style="font-family:monospace">14</span> du tableau 
<span style="font-family:monospace">CV</span>.<br>
<span style="font-family:monospace">"O"</span> a donc pour code <span style="font-family:monospace">CV[4,14]="S"</span> car :<br>
</p><table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D </td></tr>
</table><p><br>
On tape :
</p><pre class="verbatim">f(n,cara):=CV[irem(n,26),op(asc(cara))-65]:;
CV:=makemat((j,k)-&gt;char(65+irem(j+k,26)),26,26):;
codage(str):={
local j,k,c,s,code,CV;
s:=size(str);
CV:=makemat((j,k)-&gt;char(65+irem(j+k,26)),26,26):;
code:="";
pour j de 0 jusque s-1 faire
c:=str[j];
code:=code+CV[irem(j,26),op(asc(c))-65];
//code:=code+f(j,c);
fpour;
return code;
}:;
</pre><p>
On peut aussi ne pas utiliser <span style="font-family:monospace">CV</span> :<br>
On veut coder la lettre <span style="font-family:monospace">c</span> qui est d’indice <span style="font-family:monospace">j</span> dans le message.
Cette lettre <span style="font-family:monospace">c</span> est de rang <span style="font-family:monospace">op(asc(c))-65</span> dans l’alphabet.<br>
Dans le tableau <span style="font-family:monospace">CV</span> la lettre qui commence la ligne d’indice 
<span style="font-family:monospace">irem(j,26)</span> est <span style="font-family:monospace">char(irem(j,26))+65</span> et a comme code ASCII
<span style="font-family:monospace">irem(j,26)+65</span>.<br>
La lettre de cette ligne située à la colonne d’indice <span style="font-family:monospace">op(asc(c))-65</span> a 
donc comme rang <span style="font-family:monospace">k:=irem(op(asc(c))-65+irem(j,26),26)</span> dans l’alphabet.<br>
La lettre de codage de <span style="font-family:monospace">c</span> est donc char(k+65).<br>
Par exemple si on cherche à coder <span style="font-family:monospace">"O"</span> d’indice 4 du message (la 5ième lettre du message à coder).<br>
<span style="font-family:monospace">"O"</span> a comme rang <span style="font-family:monospace">op(asc("O"))-65=14</span> dans l’alphabet (<span style="font-family:monospace">"O"</span> 
est la 15ième lettre de l’alphabet).<br>
Le codage est donc la lettre située dans la ligne d’indice <span style="font-family:monospace">irem(4,26)=4</span> 
(ligne débutant par <span style="font-family:monospace">"E"</span> ayant comme rang <span style="font-family:monospace">4</span> dans l’alphabet) et 
dans la colonne <span style="font-family:monospace">14</span> c’est donc la lettre <span style="font-family:monospace">"S"</span> de rang <span style="font-family:monospace">4+14=18</span> 
de l’alphabet (car <span style="font-family:monospace">"S"</span> est la 19ième lettre de l’alphabet).<br>
 Attention si la somme des 2 indices se fait modulo 26 car cette somme est 
l’indice d’une lettre de l’alphabet et cette somme ne doit pas dépasser 25,
c’est pourquoi <span style="font-family:monospace">k:=irem(op(asc(c))-65+irem(j,26),26)</span>.<br>
<span style="font-family:monospace">"O"</span> a donc pour code <span style="font-family:monospace">"S"</span>.<br>
On tape :
</p><pre class="verbatim">codage(str):={
local j,k,c,s,code;
s:=size(str);
code:="";
pour j de 0 jusque s-1 faire
c:=str[j];
k:=irem(op(asc(c))-65+irem(j,26),26);
code:=code+char(k+65);
fpour;
return code;
}:;
</pre><p>
On tape :<br>
<span style="font-family:monospace">codage("BONJOURBONJOURBONJOURBONJOUR")</span><br>
On obtient :<br>
<span style="font-family:monospace">"BPPMSZXIWWTZGEPDDAGNLWKKHNUS"</span>
</p>
<h3 id="sec365" class="subsection">12.10.4  Le programme du décodage lettre par lettre</h3>
<p>
On utilise <span style="font-family:monospace">CV</span> dans le programme :<br>
Si la lettre à déchiffrer <span style="font-family:monospace">c</span> est d’indice <span style="font-family:monospace">j</span> dans le message à 
décoder, il faut chercher l’indice de la lettre <span style="font-family:monospace">c</span> sur la ligne 
d’indice <span style="font-family:monospace">irem(j,26)]</span> et trouver son indice <span style="font-family:monospace">k</span> dans cette ligne sans 
utiliser la fonction <span style="font-family:monospace">member</span>.<br>
Propriété de la matrice <span style="font-family:monospace">CV</span> :<br>
On remarque que si pour <span style="font-style:italic">j</span>∈ 0..25 et <span style="font-style:italic">l</span>∈  "<span style="font-style:italic">A</span>".."<span style="font-style:italic">Z</span>" on définit :<br>
<span style="font-family:monospace">f(j,l):=CV[op(asc(l))-65,irem(j,26)]</span><br>
<span style="font-family:monospace">g(j,l):=CV[irem(26-j,26),op(asc(l))-65]</span><br>
alors <br>
<span style="font-family:monospace">f(j,g(j,l))=l</span><br>
Autrement dit si la lettre <span style="font-family:monospace">c</span> est d’indice <span style="font-family:monospace">j</span> dans 
le message codé alors la lettre d’indice <span style="font-family:monospace">j</span> dans 
le message non codé est CV[irem(26-j,26),op(asc(c))-65].<br>
Par exemple si on cherche à déchiffrer
<span style="font-family:monospace">"S"</span> d’indice 4 (la 5ième lettre du message à décoder), il faut 
chercher l’indice de <span style="font-family:monospace">"S"</span> dans la ligne d’indice 4. La lettre cherchèe a 
donc comme indices dans <span style="font-family:monospace">CV</span> :<br>
<span style="font-family:monospace">[irem(26-4,26), op(asc("S"))-65]=[22,18]</span>.<br>
 C’est donc <span style="font-family:monospace">CV[22,18]="O"</span>.<br>
On tape :
</p><pre class="verbatim">g(n,cara):=CV[irem(26-n,26),op(asc(cara))-65]:;
CV:=makemat((j,k)-&gt;char(65+irem(j+k,26)),26,26):;
decodage(str):={
local j,k,c,s,mess,CV;
s:=size(str);
CV:=makemat((j,k)-&gt;char(65+irem(j+k,26)),26,26):;
mess:="";
pour j de 0 jusque s-1 faire
c:=str[j];
//mess:=mess+g(j,c);
mess:=mess+CV[irem(26-j,26),op(asc(c))-65]
fpour;
return mess;
}:;
</pre><p>
On peut aussi ne pas utiliser <span style="font-family:monospace">CV</span>.<br>
Si la lettre à déchiffrer <span style="font-family:monospace">c</span> est d’indice <span style="font-family:monospace">j</span> dans le message à 
décoder, il faut chercher la lettre <span style="font-family:monospace">c</span> sur la ligne 
d’indice <span style="font-family:monospace">irem(j,26)]</span> et trouver son indice <span style="font-family:monospace">k</span> dans cette ligne sans 
utiliser la fonction <span style="font-family:monospace">member</span>.<br>
Il suffit donc de faire la différence modulo 26, entre le rang de la 
lettre <span style="font-family:monospace">c</span> dans l’alphabet (<span style="font-family:monospace">op(asc(c))-65</span>) et l’indice 
<span style="font-family:monospace">irem(j,26)</span> soit :<br>
<span style="font-family:monospace">irem(op(asc(c))-65-irem(j,26),26)=irem(op(asc(c))-65-j,26)</span>.<br>
Par exemple si on cherche à déchiffrer
<span style="font-family:monospace">"S"</span> d’indice 4 dans le message (la 5ième lettre du message à 
décoder), il faut chercher l’indice de <span style="font-family:monospace">"S"</span> dans la ligne d’indice 4 
débutant par<span style="font-family:monospace">"E"</span> :<br>
</p><table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D </td></tr>
</table><p><br>
L’indice de <span style="font-family:monospace">"S"</span> dans la ligne d’indice 4 débutant par<span style="font-family:monospace">"E"</span> est 
donc :<br>
<span style="font-family:monospace">irem(op(asc("S"))-65-4,26)=irem(18-4,26)=14</span>.<br>
La lettre cherchèe a donc comme rang <span style="font-family:monospace">14</span> dans l’alphabet.<br>
C’est donc <span style="font-family:monospace">char(14+65)="O"</span>.<br>
On tape :
</p><pre class="verbatim">decodage1(str):={
local j,k,c,s,mess;
s:=size(str);
mess:="";
pour j de 0 jusque s-1 faire
c:=str[j];
k:=irem(op(asc(c))-65-j,26);
mess:=mess+char(k+65);
fpour;
return mess;
}:;
</pre><p>
On tape :<br>
<span style="font-family:monospace">decodage("BPPMSZXIWWTZGEPDDAGNLWKKHNUS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"BONJOURBONJOURBONJOURBONJOUR"</span>
</p>
<h3 id="sec366" class="subsection">12.10.5  Le codage de Vigenère avec une clé</h3>
<p>
On voit qu’il est facile de faire le décodage d’un message si on ne donne
pas une clé.<br>
La clé est un mot qui va nous servir à coder le message.<br>
Prenons comme exemple une clé simple : "XCAS".<br>
Si le message à coder est "BONJOUR", on écrit "XCAS" plusieurs fois sous le 
mot à coder :<br>
<span style="font-family:monospace">"BONJOUR"</span><br>
<span style="font-family:monospace">"XCASXCA"</span><br>
puis, on utilise seulement le moceau du carré de Vigenère qui correspond
à la clè á savoir que les lignes qui commencent par "X","C","A","S":<br>
</p><table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >&nbsp;</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >0</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >1</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >2</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >3</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R </td></tr>
</table><p><br>
Pour coder "BONJOUR", on code "B" avec "Y", (ligne 0 débutant par "X" et 
colonne "B"), "O" avec "Q" (ligne 1 débutant par "A" et colonne "O"), "N" 
avec "N", "J" avec "B", "O" avec "L", "U" avec "W" et "R" avec "R".<br>
Le codage de "BONJOUR" est donc "YQNBLWR".<br>
</p>
<h3 id="sec367" class="subsection">12.10.6  Le programme du tableau de Vigenère avec une clé</h3>
<p>
Voici le programme qui donne en fonction de la clé utilisée, la matrice 
extraite de la matrice <span style="font-family:monospace">CV</span> i.e. le carré de Vigenère.<br>
 On tape :
</p><pre class="verbatim">TVAC(cle):={
local sc,VAC,CV;
sc:=size(cle);
CV:=makemat((j,k)-&gt;char(65+irem(j+k,26)),26,26);
VAC:=makemat(0,sc,26);
pour j de 0 jusque sc-1 faire
VAC[j]:=CV[op(asc(cle[j])-65)];
fpour;
return VAC;
}:;
</pre><p>
On tape :<br>
<span style="font-family:monospace">TVAC("XCAS")</span><br>
On obtient :<br>
</p><table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z </td></tr>
<tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R </td></tr>
</table>
<h3 id="sec368" class="subsection">12.10.7  Le programme du codage</h3>
<p>
On peut utiliser la fonction <span style="font-family:monospace">TVAC</span> pour programmer le codage de Vigenère 
avec une clé.<br>
On veut coder la lettre <span style="font-family:monospace">c</span> qui est d’indice <span style="font-family:monospace">j</span> dans le message.
Cette lettre <span style="font-family:monospace">c</span> est de rang <span style="font-family:monospace">op(asc(c))-65</span> dans l’alphabet.<br>
Il faut donc chercher dans le tableau <span style="font-family:monospace">VAC</span> la lettre d’indice ligne 
<span style="font-family:monospace">irem(j,sc)</span> et d’indice colonne <span style="font-family:monospace">op(asc(c))-65</span> .<br>
Par exemple si la clé est <span style="font-family:monospace">"XCAS"</span> et que l’on cherche à coder
<span style="font-family:monospace">"O"</span> d’indice 4 du message (la 5ième lettre du message à coder).<br>
<span style="font-family:monospace">"O"</span> a comme rang <span style="font-family:monospace">op(asc("O"))-65=14</span> dans l’alphabet (<span style="font-family:monospace">"O"</span> 
est la 15ième lettre de l’alphabet).<br>
Le codage est donc la lettre située dans la ligne d’indice <span style="font-family:monospace">irem(4,4)=0</span> 
(ligne débutant par <span style="font-family:monospace">"X"</span>) et dans la colonne <span style="font-family:monospace">14</span> du tableau 
<span style="font-family:monospace">VAC</span>.<br>
<span style="font-family:monospace">"O"</span> a donc pour code <span style="font-family:monospace">VAC[0,14]="L"</span> car :<br>
</p><table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W </td></tr>
</table><p><br>
On tape :
</p><pre class="verbatim">codagec0(str,cle):={
local j,k,c,s,sc,VAC,code;
s:=size(str);
VAC:=TVAC(cle);
sc:=size(cle);
code:="";
pour j de 0 jusque s-1 faire
c:=str[j];
code:=code+VAC[irem(j,sc),op(asc(c))-65];
fpour;
return code;
}:;
</pre><p>
On tape :<br>
<span style="font-family:monospace">codagec0("BONJOUR","XCAS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"YQNBLWR"</span><br>
On tape :<br>
<span style="font-family:monospace">codagec0("BONJOURBONJOUR","XCAS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"YQNBLWRTLPJGRT"</span><br>

On peut aussi n’utiliser que le carré de Vigenère <span style="font-family:monospace">CV</span> pour coder.<br>
On veut coder la lettre <span style="font-family:monospace">c</span> qui est d’indice <span style="font-family:monospace">j</span> dans le message.
Cette lettre <span style="font-family:monospace">c</span> est de rang <span style="font-family:monospace">op(asc(c))-65</span> dans l’alphabet.<br>
Il faut donc chercher dans le tableau <span style="font-family:monospace">CV</span> la lettre située dans la ligne 
débutant par <span style="font-family:monospace">cle[irem(j,sc)]</span> qui est d’indice 
<span style="font-family:monospace">op(asc(cle[irem(j,sc)])-65)</span> et d’indice colonne <span style="font-family:monospace">op(asc(c))-65</span>.<br>
Par exemple si la clé est <span style="font-family:monospace">"XCAS"</span> et que l’on cherche à coder
<span style="font-family:monospace">"O"</span> d’indice 4 du message (la 5ième lettre du message à coder).<br>
<span style="font-family:monospace">"O"</span> a comme rang <span style="font-family:monospace">op(asc("O"))-65=14</span> dans l’alphabet (<span style="font-family:monospace">"O"</span> 
est la 15ième lettre de l’alphabet et <span style="font-family:monospace">14</span> est l’indice colonne de 
<span style="font-family:monospace">"O"</span> du tableau CV).<br>
Le codage est donc la lettre située dans le tableau <span style="font-family:monospace">CV</span> à la ligne 
d’indice <span style="font-family:monospace">23</span> (<span style="font-family:monospace">23</span> est obtenu avec
<span style="font-family:monospace">op(asc(cle[irem(4,4)])-65)=op(asc(cle[0]))-65</span>)
et à la colonne d’indice <span style="font-family:monospace">14</span>.<br>
<span style="font-family:monospace">"O"</span> a donc pour code <span style="font-family:monospace">CV[23,14]="L"</span>.<br>
On tape : 
</p><pre class="verbatim">)
codagec1(str,cle):={
local j,k,c,s,sc,code,CV;
s:=size(str);
sc:=size(cle);
CV:=makemat((j,k)-&gt;char(65+irem(j+k,26)),26,26);
code:="";
pour j de 0 jusque s-1 faire
c:=str[j];
code:=code+CV[op(asc(cle[irem(j,sc)]))-65,op(asc(c))-65];
fpour;
return code;
}:;
</pre><p>
On tape :<br>
<span style="font-family:monospace">codagec1("BONJOUR","XCAS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"YQNBLWR"</span><br>
On tape :<br>
<span style="font-family:monospace">codagec1("BONJOURBONJOUR","XCAS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"YQNBLWRTLPJGRT"</span><br>
On tape :<br>
<span style="font-family:monospace">codagec1("BONJOURBONJOURBONJOURBONJOUR","XCAS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"YQNBLWRTLPJGRTBGKLOMODOFGQUJ"</span></p>
<h3 id="sec369" class="subsection">12.10.8  Le programme du décodage</h3>
<p>
Comme pour le codage on peut utiliser la fonction <span style="font-family:monospace">TVAC</span> pour programmer le 
décodage de Vigenère avec une clé.<br>
Si la lettre à déchiffrer <span style="font-family:monospace">c</span> est d’indice <span style="font-family:monospace">j</span> dans le message à 
décoder, il faut chercher l’indice de la lettre <span style="font-family:monospace">c</span> sur la ligne 
débutant par la lettre <span style="font-family:monospace">cle[irem(j,sc)]=VAC[0,irem(j,sc)]</span> et trouver 
son indice <span style="font-family:monospace">k</span> dans cette ligne sans utiliser la fonction <span style="font-family:monospace">member</span>. 
Il suffit donc de faire la différence modulo 26, entre le code ASCII de la 
lettre <span style="font-family:monospace">c</span> et celui de la lettre <span style="font-family:monospace">VAC[0,irem(j,sc)]</span>.<br>
Par exemple si la clé est <span style="font-family:monospace">"XCAS"</span> et que l’on cherche à déchiffrer
<span style="font-family:monospace">"L"</span> d’indice 4 (la 5ième lettre du message à décoder), il faut 
chercher l’indice de <span style="font-family:monospace">"L"</span> dans la ligne débutant par <span style="font-family:monospace">VAC[0,0]="X"</span> 
(<span style="font-family:monospace">"X"</span> est <span style="font-family:monospace">VAC[0,0]</span>) :<br>
</p><table border=1  style="border-spacing:0;" class="cellpadding1"><tr><td style="vertical-align:top;text-align:left;border:solid 1px;" >X</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Y</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Z</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >A</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >B</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >C</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >D</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >E</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >F</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >G</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >H</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >I</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >J</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >K</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >L</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >M</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >N</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >O</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >P</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >Q</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >R</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >S</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >T</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >U</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >V</td><td style="vertical-align:top;text-align:left;border:solid 1px;" >W </td></tr>
</table><p>
On a :<br>
<span style="font-family:monospace">VAC[0,0]=VAC[0,0]="X"</span>
<span style="font-family:monospace">asc("L")=[76]</span> et <span style="font-family:monospace">asc("X")=[88]</span><br>
<span style="font-family:monospace">op(asc("L"))=76</span> et <span style="font-family:monospace">op(asc("X"))=88</span><br>
<span style="font-family:monospace">op(asc("L"))-op(asc("X"))=-12</span><br>
L’indice de <span style="font-family:monospace">"L"</span> dans la ligne est donc <span style="font-family:monospace">irem(-12,26)=14</span> et<br>
<span style="font-family:monospace">char(14+65)="O"</span>.
Le décodage de <span style="font-family:monospace">"L"</span> d’indice 4 dans le message à 
décoder est donc <span style="font-family:monospace">"O"</span> lorsque la clé est <span style="font-family:monospace">"XCAS"</span>.<br>
On tape :
</p><pre class="verbatim">decodagec0(str,cle):={
local j,k,c,s,sc,VAC,mess;
s:=size(str);
sc:=size(cle);
VAC:=TVAC(cle);
mess:="";
pour j de 0 jusque s-1 faire
c:=str[j];
//k:=member(c,VAC[irem(j,sc)])-1;
//k:=irem(op(asc(c))-op(asc(cle[irem(j,sc)])),26);
k:=irem(op(asc(c))-op(asc(VAC[0,irem(j,sc)])),26);
mess:=mess+char(k+65);
fpour;
return mess;
}:;
</pre><p>
On tape :<br>
<span style="font-family:monospace">decodagec0("YQNBLWR","XCAS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"BONJOUR"</span>
On tape :<br>
<span style="font-family:monospace">decodagec0("YQNBLWRTLPJGRT","XCAS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"BONJOURBONJOUR"</span>
On tape :<br>
<span style="font-family:monospace">decodagec0("CYCPAQGKE","CHAISE")</span><br>
On obtient :<br>
<span style="font-family:monospace">"ARCHIMEDE"</span><br>
Comme pour le codage on peut n’utiliser que le carré de Vigenère <span style="font-family:monospace">CV</span> 
pour décoder.<br>
On tape :
</p><pre class="verbatim">decodagec1(str,cle):={
local j,k,c,s,sc,VAC,mess,CV;
s:=size(str);
sc:=size(cle);
CV:=makemat((j,k)-&gt;char(65+irem(j+k,26)),26,26):;
mess:="";
pour j de 0 jusque s-1 faire
c:=str[j];
//mess:=mess+CV[26-op(asc(cle[irem(j,sc)]))+65,op(asc(c))-65];
k:=irem(op(asc(c))-op(asc(cle[irem(j,sc)])),26);
mess:=mess+char(k+65);
fpour;
return mess;
}:;
</pre><p>
On tape :<br>
<span style="font-family:monospace">decodagec("YQNBLWR","XCAS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"BONJOUR"</span>
On tape :<br>
<span style="font-family:monospace">decodagec("YQNBLWRTLPJGRT","XCAS")</span><br>
On obtient :<br>
<span style="font-family:monospace">"BONJOURBONJOUR"</span>
On tape :<br>
<span style="font-family:monospace">decodagec("CYCPAQGKE","CHAISE")</span><br>
On obtient :<br>
<span style="font-family:monospace">"ARCHIMEDE"</span><br>
<span style="font-weight:bold">Remarque</span><br>
Lorsqu’on code avec le carré de Vigenère c’est comme si on avait choisit 
comme clé les 26 lettres de l’alphabet.<br>
Pour passer des programmes de codage et de décodage sans clé avec les 
programmes de codage et de décodage avec clé qui n’utilise que CV, il 
suffit de remplacer l’indice <span style="font-family:monospace">j</span> de la lettre à coder par 
<span style="font-family:monospace">jc:=op(asc(cle[irem(j,sc)]))-65</span> où <span style="font-family:monospace">sc</span> représente la longueur de
la clé.<br>
Pour le codage on remplace :<br>
<span style="font-family:monospace">code:=code+CV[irem(j,26),op(asc(c))-65];</span><br>
par :<br>
<span style="font-family:monospace">code:=code+CV[op(asc(cle[irem(j,sc)]))-65,op(asc(c))-65];</span><br>
comme <span style="font-family:monospace">0&lt;=jc=op(asc(cle[irem(j,sc)]))-65&lt;=25</span> il est inutile de chercher le 
reste de sa division par 26.<br>
Pour le décodage on remplace :<br>
<span style="font-family:monospace">mess:=mess+CV[irem(26-j,26),op(asc(c))-65];</span><br>
par :<br>
<span style="font-family:monospace">mess:=mess+CV[26-op(asc(cle[irem(j,sc)]))+65,op(asc(c))-65];</span>
ici encore le reste de de la division par 26 de <span style="font-family:monospace">26-jc</span> est inutile !
</p>
<h3 id="sec370" class="subsection">12.10.9  Peut-on décrypter sans connaitre la clé ?</h3>
<p>
Dans ce type de codage dit polyalphabétiques, on ne peut pas utiliser 
l’analyse des fréquences puisqu peusqu’un même caractère peut être 
codé par des caractères différents.<br>
Mais le britannique Ch Babbage au 19 ième siecle a trouvé la parade.<br>
Si on a choisit une clé de 4 lettres, chaque caractère peut être 
codé par au plus 4 caractères différents.<br>
Si le texte est suffisamment long, on peut essayer de repérer dans le texte 
codé les mots qui se repétent et d’en déduire le nombre de lettres de la 
clé.<br>
Par exemple :<br>
<span style="font-family:monospace">codagec1("BONJOURBONJOURBONJOURBONJOURBONJOUR","XCAS")</span><br>
renvoie <br>
<span style="font-family:monospace">"YQNBLWRTLPJGRTBGKLOMODOFGQUJYQNBLWR"</span><br>
On remarque que le premier et le dernier <span style="font-family:monospace">"BONJOUR"</span> sont codés de la 
même façon et qu’entre 2 <span style="font-family:monospace">"Y"</span> y a 27 lettres, 28 est donc 
un multiple du nombre de lettres de la clé......
Si on a plusieurs répétitions le nombre de lettres de la clé est un 
diviseur commun du nombre de lettre +1 qui sépare ces répétitions.<br>
Si le nombre de lettres de la clé est 4 il reste alors à décoder 4 
chiffrements monoalphabétiques ....
</p>
<h3 id="sec371" class="subsection">12.10.10  Exercice : codage et décodage globalement</h3>
<h4 id="sec372" class="subsubsection">Codage sans une clé</h4>
<p>
Au lieu de coder ou de décoder lettre par lettre on va le faire globalement
<span style="font-family:monospace">ordres(mess):=asc(mess)-[65$(k=1..size(mess))];</span>
<span style="font-family:monospace">transfCV(L):=[irem(j+L[j],26)$(j=0..size(L)-1)];</span><br>
<span style="font-family:monospace">codeA(LT):=[char(LT[j]+65)$(j=0..size(LT)-1)];</span><br>
<span style="font-family:monospace">mot(L):=ifte(L==[],"",L[0]+mot(tail(L)));</span><br>
Par exemple :<br>
<span style="font-family:monospace">L:=ordres(("BONJOURBONJOURBONJOURBONJOURBONJOUR")</span><br>
renvoie <br>
<span style="font-family:monospace">[1,14,13,9,14,20,17,1,14,13,9,14,20,17,1,14,13,9,14,20,17,1,14,13,9,14,20,17]</span><br>
<span style="font-family:monospace">LT:=transfCV(L)</span><br>
renvoie <br>
<span style="font-family:monospace">[1,15,15,12,18,25,23,8,22,22,19,25,6,4,15,3,3,0,6,13,11,22,10,10,7,13,20,18]</span><br>
<span style="font-family:monospace">LA:=codeA(LT)</span><br>
renvoie <br>
<span style="font-family:monospace">["B","P","P","M","S","Z","X","I","W","W","T","Z","G","E","P","D","D","A","G","N","L","W","K","K","H","N","U","S"]</span><br>
<span style="font-family:monospace">messcode:=mot(LA)</span><br>
renvoie <br>
<span style="font-family:monospace">"BPPMSZXIWWTZGEPDDAGNLWKKHNUS"</span></p>
<h4 id="sec373" class="subsubsection">Décodage sans une clé</h4>
<p>
Il suffit de transformer <span style="font-family:monospace">transfCV</span> en <span style="font-family:monospace">transgCV</span> en utilisant la fonction <span style="font-style:italic">g</span> inverse de <span style="font-style:italic">f</span> :<br>
<span style="font-family:monospace">transgCV(L):=[irem(26-j+L[j],26)$(j=0..size(L)-1)];</span>
Par exemple :<br>
<span style="font-family:monospace">Lde:=ordres("BPPMSZXIWWTZGEPDDAGNLWKKHNUS")</span>
renvoie
<span style="font-family:monospace">[1,15,15,12,18,25,23,8,22,22,19,25,6,4,15,3,3,0,6,13,11,22,10,10,7,13,20,18]</span>
<span style="font-family:monospace">LTde:=transgCV(Lde)</span><br>
renvoie <br>
<span style="font-family:monospace">[1,14,13,9,14,20,17,1,14,13,9,14,20,17,1,14,13,9,14,20,17,1,14,13,9,14,20,17]</span><br>
<span style="font-family:monospace">mot(codeA(LTde))</span><br>
renvoie <br>
<span style="font-family:monospace">"BONJOURBONJOURBONJOURBONJOUR"</span>
</p>
<h4 id="sec374" class="subsubsection">Codage avec une clé</h4>
<p>
<span style="font-family:monospace">ordres(mess):=asc(mess)-[65$(k=1..size(mess))];</span>
<span style="font-family:monospace">transfCVcle(L,cle):=[irem((ordres(cle))[irem(j,size(cle))]+L[j],26)$(j=0..size(L)-1)];</span><br>
<span style="font-family:monospace">codeA(LT):=[char(LT[j]+65)$(j=0..size(LT)-1)];</span><br>
<span style="font-family:monospace">mot(L):=ifte(L==[],"",L[0]+mot(tail(L)));</span><br>
Par exemple :<br>
<span style="font-family:monospace">L:=ordres(("BONJOURBONJOURBONJOURBONJOURBONJOUR")</span><br>
renvoie <br>
<span style="font-family:monospace">[1,14,13,9,14,20,17,1,14,13,9,14,20,17,1,14,13,9,14,20,17,1,14,13,9,14,20,17]</span><br>
<span style="font-family:monospace">LTcle:=transfCVcle(L,"XCAS"</span><br>
renvoie <br>
<span style="font-family:monospace">[24,16,13,1,11,22,17,19,11,15,9,6,17,19,1,6,10,11,14,12,14,3,14,5,6,16,20,9]</span><br>
<span style="font-family:monospace">LAcle:=codeA(LTcle)</span><br>
renvoie <br>
<span style="font-family:monospace">["Y","Q","N","B","L","W","R","T","L","P","J","G","R","T","B","G","K","L","O","M","O","D","O","F","G","Q","U","J"]</span><br>
<span style="font-family:monospace">messcodecle:=mot(LAcle)</span><br>
renvoie <br>
<span style="font-family:monospace">"YQNBLWRTLPJGRTBGKLOMODOFGQUJ"</span>
</p>
<h4 id="sec375" class="subsubsection">Décodage avec une clé</h4>
<p>
Il suffit de transformer <span style="font-family:monospace">transfCVcle</span> en <span style="font-family:monospace">transgCVcle</span> en utilisant la fonction <span style="font-style:italic">g</span> inverse de <span style="font-style:italic">f</span> :<br>
<span style="font-family:monospace">transgCVcle(L,cle):=[irem(26-(ordres(cle))[irem(j,size(cle))]+L[j],26)$(j=0..size(L)-1)];</span>
Par exemple :<br>
<span style="font-family:monospace">Ldecle:=ordres("YQNBLWRTLPJGRTBGKLOMODOFGQUJ")</span>
renvoie
<span style="font-family:monospace">[24,16,13,1,11,22,17,19,11,15,9,6,17,19,1,6,10,11,14,12,14,3,14,5,6,16,20,9]</span>
<span style="font-family:monospace">LTdecle:=transgCVcle(Ldecle,"XCAS")</span><br>
renvoie <br>
<span style="font-family:monospace">[1,14,13,9,14,20,17,1,14,13,9,14,20,17,1,14,13,9,14,20,17,1,14,13,9,14,20,17]</span><br>
<span style="font-family:monospace">mot(codeA(LTde))</span><br>
renvoie <br>
<span style="font-family:monospace">"BONJOURBONJOURBONJOURBONJOUR"</span>
</p>
<h4 id="sec376" class="subsubsection">Le programme qui code et décode avec ou sans clé</h4>
<p><a id="sec:coddecod"></a>
Soit un message <span style="font-family:monospace">mess</span> qui n’utilise que les 26 lettres majuscules de 
l’alphabet.
Voici le programme définitif qui code (si <span style="font-family:monospace">n&gt;0</span>), qui décode (si 
<span style="font-family:monospace">n&lt;0</span>) avec une clé ou sans clé (si <span style="font-family:monospace">cle=""</span>).
On écrit la procédure récursive <span style="font-family:monospace">mot</span> qui à une liste de 
caractères renvoie le mot formé par ses caractères.
</p><pre class="verbatim">mot(L):=ifte(L==[],"",L[0]+mot(tail(L)));
codage(mess,cle,n):={
local s,sc,messc,messcT,messTL;
  si (n==0) alors retourne "erreur n!=0" fsi;
  si (cle=="") alors cle:=char((65+j)$(j=0..25)); fsi;
  s:=size(mess);
  sc:=size(cle);
  messc:=asc(mess)-[65$ s];
  clec:=asc(cle)-[65$ sc];
  messcT:=[irem(sign(n)*clec[irem(j,sc)]+messc[j],26)$(j=0..s-1)];
  messTL:=[char(messcT[j]+65)$(j=0..s-1)];
  retourne mot(messTL);
}:;
</pre><p>
On tape :<br>
<span style="font-family:monospace">codage("BONJOURBONJOURBONJOURBONJOUR","",1)</span><br>
On obtient :<br>
<span style="font-family:monospace">"BPPMSZXIWWTZGEPDDAGNLWKKHNUS"</span><br>
On tape :<br>
<span style="font-family:monospace">codage("BPPMSZXIWWTZGEPDDAGNLWKKHNUS","",-1)</span><br>
On obtient :<br>
<span style="font-family:monospace">"BONJOURBONJOURBONJOURBONJOUR"</span><br>
On tape :<br>
<span style="font-family:monospace">codage("BONJOURBONJOURBONJOURBONJOUR","XCAS",1)</span><br>
On obtient :<br>
<span style="font-family:monospace">"YQNBLWRTLPJGRTBGKLOMODOFGQUJ"</span><br>
On tape :<br>
<span style="font-family:monospace">codage("YQNBLWRTLPJGRTBGKLOMODOFGQUJ","XCAS",-1)</span><br>
On obtient :<br>
<span style="font-family:monospace">"BONJOURBONJOURBONJOURBONJOUR"</span>
</p>
<h2 id="sec377" class="section">12.11  Codage RSA</h2>
<h3 id="sec378" class="subsection">12.11.1  Le principe du codage avec clé publique et clé secrète</h3>
<p>
On suppose que l’on dispose d’un annuaire de clés (ce sont les clés 
publiques comme un annuaire de téléphone) qui permet d’envoyer à 
quelqu’un (par exemple à Tartanpion) un message que l’on code en se servant 
de la clé publique de Tartanpion. 
Mais seul Tartanpion pourra décoder les messages qu’il reçoit : il pourra
le faire grâce à sa clé secréte.<br>
Autrement dit tout le monde sait comment il faut coder les messages pour 
Tartanpion : la fonction <span style="font-style:italic">f</span><sub><span style="font-style:italic">T</span></sub> de codage pour Tartanpion est connue mais la 
fonction <span style="font-style:italic">g</span><sub><span style="font-style:italic">T</span></sub> de décodage n’est connue que de Tartanpion car il existe des 
fonctions inversibles <span style="font-style:italic">f</span> dont l’inverse <span style="font-style:italic">g</span> est difficile à trouver.<br>
</p>
<h3 id="sec379" class="subsection">12.11.2  Codage avec signature, clé publique et clé secrète</h3>
<p>
Si Tartanpion reçoit un message provenant de Martin. Comment Tartanpion
peut-il être sûr que c’est bien Martin qui lui a envoyé ce message vu 
que sa clé publique est accessible à tout le monde ?<br>
Martin et Tartanpion peuvent convenir de faire un codage avec signature :<br>
Si la fonction <span style="font-style:italic">f</span><sub><span style="font-style:italic">T</span></sub> de codage pour Tartanpion est connue mais la 
fonction <span style="font-style:italic">g</span><sub><span style="font-style:italic">T</span></sub> de décodage n’est connue que de Tartanpion et
si la fonction <span style="font-style:italic">f</span><sub><span style="font-style:italic">M</span></sub> de codage pour Martin est connue mais la 
fonction <span style="font-style:italic">g</span><sub><span style="font-style:italic">M</span></sub> de décodage n’est connue que de Martin alors,<br>
Martin codera les messages pour Tartanpion avec <span style="font-style:italic">f</span><sub><span style="font-style:italic">T</span></sub>o<span style="font-style:italic">g</span><sub><span style="font-style:italic">M</span></sub> c’est à dire en 
utilisant sa clé secréte puis la clé publique de Tartanpion et<br>
Tartanpion décodera les messages provvenant de Martin avec <span style="font-style:italic">f</span><sub><span style="font-style:italic">M</span></sub>o<span style="font-style:italic">g</span><sub><span style="font-style:italic">T</span></sub> 
c’est à dire en utilisant sa clé secréte et la clé publique de Martin. 
</p>
<h3 id="sec380" class="subsection">12.11.3  Le cryptage des nombres avec la méthode RSA </h3>
<p>
Cette méthode est due à Rivest Shamir et Adleman en 1977. Elle est basée 
sur le fait qu’il est facile de savoir si un nombre entier très grand <span style="font-style:italic">p</span> est 
premier, facile de faire le produit <span style="font-style:italic">n</span> de 2 nombres premiers tres grands <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> MAIS très difficile étant donné <span style="font-style:italic">n</span> de retrouver <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> c’est à dire de trouver la décomposition de <span style="font-style:italic">n</span> en facteurs premiers.<br>
Tartanpion pour établir ses clés, choisit deux grand nombres premiers <span style="font-style:italic">p</span> 
et <span style="font-style:italic">q</span> et pose <span style="font-style:italic">n</span>=<span style="font-style:italic">pq</span>, puis 
il choisit <span style="font-style:italic">m</span> un nombre premier avec (<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1) (par exemple il prend pour 
<span style="font-style:italic">m</span> un nombre premier plus grand que (<span style="font-style:italic">p</span>−1)/2 et que (<span style="font-style:italic">q</span>−1)/2).<br>
Il calcule l’entier <span style="font-style:italic">u</span> pour que <span style="font-style:italic">u</span>*<span style="font-style:italic">m</span>=1 mod(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1) (d’après 
l’identité de Bézout il existe des entiers <span style="font-style:italic">u</span> et <span style="font-style:italic">v</span> tel que 
<span style="font-style:italic">u</span>*<span style="font-style:italic">m</span>=1+<span style="font-style:italic">v</span>(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)). Puis il 
met dans l’annuaire les nombres <span style="font-style:italic">u</span> et <span style="font-style:italic">n</span> (quand <span style="font-style:italic">n</span> est grand <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> 
sont difficiles à obtenir à partir de <span style="font-style:italic">n</span>), le couple (<span style="font-style:italic">u</span>,<span style="font-style:italic">n</span>) est la clé 
publique alors que (<span style="font-style:italic">m</span>,<span style="font-style:italic">n</span>) est la clé secréte qui va servir à décoder 
le message : bien sûr <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> restent secrets, car sinon n’importe qui
peut calculer <span style="font-style:italic">m</span> en fonction de <span style="font-style:italic">u</span> avec l’identité de Bézout.</p><p>La fonction de codage <span style="font-style:italic">f</span> est la suivante :<br>
à un entier <span style="font-style:italic">a</span> inférieur à <span style="font-style:italic">n</span>=<span style="font-style:italic">pq</span>
<span style="font-style:italic">f</span> fait correspondre <span style="font-style:italic">a</span><sup><span style="font-style:italic">u</span></sup> mod<span style="font-style:italic">n</span>.</p><p>La fonction de décodage <span style="font-style:italic">g</span> est la suivante :<br>
à un entier <span style="font-style:italic">b</span>, <span style="font-style:italic">g</span> on fait correspondre <span style="font-style:italic">b</span><sup><span style="font-style:italic">m</span></sup> mod<span style="font-style:italic">n</span>.</p><p>Pour montrer que <span style="font-style:italic">g</span>(<span style="font-style:italic">f</span>(<span style="font-style:italic">a</span>))=<span style="font-style:italic">a</span>, on utilise le petit théorème de Fermat 
amélioré:<br>
si <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> sont premiers, si <span style="font-style:italic">n</span>=<span style="font-style:italic">pq</span> si <span style="font-style:italic">a</span> est inférieur à <span style="font-style:italic">n</span>=<span style="font-style:italic">pq</span>
alors :<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)+1</sup>=<span style="font-style:italic">a</span>  mod  <span style="font-style:italic">n</span><br>
On peut appliquer ce théorème ici car :
- si <span style="font-style:italic">a</span> est premier avec <span style="font-style:italic">n</span>, <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> sont premiers, <span style="font-style:italic">n</span>=<span style="font-style:italic">pq</span> et donc 
<span style="font-style:italic">a</span> est premier avec <span style="font-style:italic">p</span> et est premier avec <span style="font-style:italic">q</span> donc :<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">v</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)</sup>=1<sup><span style="font-style:italic">v</span></sup>=1  mod  <span style="font-style:italic">n</span> (d’après le petit théorème de Fermat)
<span style="font-style:italic">a</span><sup><span style="font-style:italic">p</span>−1</sup>=1  mod <span style="font-style:italic">p</span> et <span style="font-style:italic">a</span><sup><span style="font-style:italic">q</span>−1</sup>=1  mod <span style="font-style:italic">q</span> donc <br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">v</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)</sup>=1<sup><span style="font-style:italic">v</span></sup>=1  mod  <span style="font-style:italic">p</span> et <span style="font-style:italic">a</span><sup><span style="font-style:italic">v</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)</sup>=1<sup><span style="font-style:italic">v</span></sup>=1  mod <span style="font-style:italic">q</span><br>
 donc<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">v</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)</sup>=1<sup><span style="font-style:italic">v</span></sup>=1  mod  <span style="font-style:italic">n</span>.<br>
 - si <span style="font-style:italic">a</span> n’est pas premier avec <span style="font-style:italic">n</span>, c’est que <span style="font-style:italic">a</span> est soit un multiple de 
<span style="font-style:italic">p</span> soit un multiple de <span style="font-style:italic">q</span> (puisque <span style="font-style:italic">a</span>&lt;<span style="font-style:italic">n</span>=<span style="font-style:italic">pq</span>). Supposons que <span style="font-style:italic">a</span> soit un 
multiple de <span style="font-style:italic">p</span>, <span style="font-style:italic">a</span> est donc premier avec <span style="font-style:italic">q</span> puisque <span style="font-style:italic">a</span>&lt;<span style="font-style:italic">p</span>*<span style="font-style:italic">q</span> et on a :<br>
<span style="font-style:italic">a</span>=0 mod<span style="font-style:italic">p</span> donc <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)+1</sup>=<span style="font-style:italic">a</span>=0  mod  <span style="font-style:italic">p</span><br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">q</span>−1</sup>=1  mod  <span style="font-style:italic">q</span> car <span style="font-style:italic">q</span> est premier et <span style="font-style:italic">a</span> est premier avec <span style="font-style:italic">q</span> (th de 
Fermat), donc <br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)+1</sup>=<span style="font-style:italic">a</span>  mod  <span style="font-style:italic">q</span><br>
Donc <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)+1</sup>−<span style="font-style:italic">a</span> est un multiple de <span style="font-style:italic">p</span> et de <span style="font-style:italic">q</span> donc est un
multiple de <span style="font-style:italic">n</span>=<span style="font-style:italic">pq</span> (car <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> sont premiers).<br>
on a donc bien :<br>
<span style="font-style:italic">g</span>(<span style="font-style:italic">f</span>(<span style="font-style:italic">a</span>))=<span style="font-style:italic">g</span>(<span style="font-style:italic">a</span><sup><span style="font-style:italic">u</span></sup>)  mod  <span style="font-style:italic">n</span>=<span style="font-style:italic">a</span><sup><span style="font-style:italic">um</span></sup>  mod  <span style="font-style:italic">n</span>=<span style="font-style:italic">a</span><sup><span style="font-style:italic">v</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)+1</sup> mod  <span style="font-style:italic">n</span>=<span style="font-style:italic">a</span><br>
Un exemple :<br>
<span style="font-style:italic">p</span>=123456791 et <span style="font-style:italic">q</span>=1234567891 <br>
:
<span style="font-style:italic">n</span>=<span style="font-style:italic">p</span>*<span style="font-style:italic">q</span>=152415790094497781 <br>
ϕ=(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)=152415788736473100<br>
<span style="font-style:italic">m</span>=12345701 (<span style="font-style:italic">m</span> est un nombre premier et <span style="font-style:italic">m</span> ne divise pas ϕ)<br>
On cherche <span style="font-style:italic">u</span> en tapant <span style="font-family:monospace"><span style="font-style:italic">inv</span></span><span style="font-family:monospace">(</span><span style="font-family:monospace"><span style="font-style:italic">m</span></span><span style="font-family:monospace"> % ϕ)</span> on trouve :<br>
<span style="font-family:monospace">(-36645934363466299) % 152415788736473100 </span> et on a :<br>
<span style="font-style:italic">u</span>=−36645934363466299+ϕ=115769854373006801<br>
Pour coder, on utilise la clé publique <span style="font-style:italic">u</span> et <span style="font-style:italic">n</span> et pour décoder, on 
utilise la clé secréte <span style="font-style:italic">m</span> et <span style="font-style:italic">n</span>.</p><p><span style="font-weight:bold">Remarque</span><br>
Pour passer d’un message à une suite de nombres, on groupe
plusieurs caractères (car sinon on pourrait décrypter le
message en utilisant des statistiques de fréquence des
caractères en fonction de la langue), le groupement est
l’écriture d’un nombre en une base donnée (256 ici correspondant
au codage ASCII d’un caractère), par exemple, puisque asc("BONJOUR")=[66,79,78,74,79,85,82], si on groupe par 3, 
<span style="font-family:monospace">BONJOUR </span> devient les nombres
(66*256+79)*256+78=4345678, (74*256+79)*256+85=4869973, (82*256+0)*256+0 =5373952 qui seront transformés par 
<span style="font-style:italic">f</span> en 156330358492191937, 126697584810299952, 50295601528998788 car
powmod(4345678,u,n)=15633035849219193 etc...<br>
Pour décoder on applique à ces nombres la fonction <span style="font-style:italic">g</span> on a :<br>
powmod(15633035849219193,m,n)=4345678 etc...</p>
<h3 id="sec381" class="subsection">12.11.4  La fonction de codage</h3>
<p>
Tartanpion choisit 2 grands nombres premiers <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> et met dans l’annuaire 
le nombre <span style="font-style:italic">n</span>=<span style="font-style:italic">p</span>*<span style="font-style:italic">q</span>.
Il est facile d’obtenir <span style="font-style:italic">n</span> à partir de <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> mais par contre <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span>
sont difficiles à obtenir à partir de <span style="font-style:italic">n</span> car la décomposition en 
facteurs premiers de grands nombres est longue et presque impossible si <span style="font-style:italic">n</span> a 
plus de 130 chiffres.
</p>
<h4 id="sec382" class="subsubsection">Première étape</h4>
<p>
On découpe le message en tranche ayant <span style="font-style:italic">ncara</span> caractères.
On choisit <span style="font-style:italic">ncara</span> en fonction des nombres <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> pour que 256<sup><span style="font-style:italic">ncara</span></sup> 
soit inférieur à <span style="font-style:italic">p</span> et à <span style="font-style:italic">q</span>. En effet, 
on considère que la tranche du message que l’on veut coder est l’écriture 
en base 256 d’un nombre : par exemple si <span style="font-style:italic">ncara</span>=5 "BABAR" est le nombre 
<span style="font-style:italic">a</span>=66*256<sup>4</sup>+65*256<sup>3</sup>+66*256<sup>2</sup>+65*256+82=284562702674
et on verra dans la section suivante que ces nombres <span style="font-style:italic">a</span>
doivent être premiers avec <span style="font-style:italic">n</span>=<span style="font-style:italic">p</span>*<span style="font-style:italic">q</span>, donc par exemple être inférieurs à 
<span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> (ce qui est vérifié si 256<sup><span style="font-style:italic">ncara</span></sup>&lt;<span style="font-style:italic">p</span> et 256<sup><span style="font-style:italic">ncara</span></sup>&lt;<span style="font-style:italic">q</span> 
puisque <span style="font-style:italic">a</span>&lt;256<sup><span style="font-style:italic">ncara</span></sup>).) 
</p>
<h4 id="sec383" class="subsubsection">Deuxième étape : un peu de maths</h4>
<p>
Le petit théorème de Fermat dit que :<br>
si <span style="font-style:italic">n</span> est premier et si <span style="font-style:italic">a</span> est premier avec <span style="font-style:italic">n</span> alors <span style="font-style:italic">a</span><sup><span style="font-style:italic">n</span>−1</sup>=1  mod <span style="font-style:italic">n</span>. <br>
Une généralisation (simple) du petit théorème de Fermat est :<br>
si <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> sont premiers, si <span style="font-style:italic">a</span> est quelconque, si <span style="font-style:italic">n</span>=<span style="font-style:italic">p</span>*<span style="font-style:italic">q</span> et si <span style="font-style:italic">k</span> est 
un entier, alors :<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)+1</sup>=<span style="font-style:italic">a</span>  mod <span style="font-style:italic">p</span>*<span style="font-style:italic">q</span>. <br>
Montrons cette généralisation simple :<br>
- si <span style="font-style:italic">a</span> est un multiple de <span style="font-style:italic">n</span> c’est évident puisque <br>
<span style="font-style:italic">a</span>=0 mod<span style="font-style:italic">n</span> donc <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)+1</sup>=<span style="font-style:italic">a</span>=0  mod <span style="font-style:italic">n</span> 
- si <span style="font-style:italic">a</span> est premier avec <span style="font-style:italic">n</span> alors <span style="font-style:italic">a</span> est premier avec <span style="font-style:italic">q</span> (car <span style="font-style:italic">q</span> est un 
diviseur de <span style="font-style:italic">n</span>),<br>
puisque <span style="font-style:italic">a</span> est premier avec <span style="font-style:italic">q</span> on a :<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">q</span>−1</sup>=1  mod <span style="font-style:italic">q</span> (application du petit théorème de 
Fermat) et<br>
donc <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">q</span>−1)*(<span style="font-style:italic">p</span>−1)</sup>=1  mod <span style="font-style:italic">q</span> <br>
puisque <span style="font-style:italic">a</span> est premier avec <span style="font-style:italic">p</span> on a:<br>
 <span style="font-style:italic">a</span><sup><span style="font-style:italic">p</span>−1</sup>=1  mod <span style="font-style:italic">p</span> (application du petit 
théorème de Fermat)<br>
donc <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)</sup>=1  mod <span style="font-style:italic">p</span> .<br>
On en déduit donc que :<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)</sup>−1=0  mod <span style="font-style:italic">p</span> et <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)</sup>−1=0  mod <span style="font-style:italic">q</span>
c’est à dire que :<br>
 <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)</sup>−1 est un multiple de <span style="font-style:italic">p</span> et de <span style="font-style:italic">q</span> donc 
de <span style="font-style:italic">n</span>=<span style="font-style:italic">p</span>*<span style="font-style:italic">q</span> puisque <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> sont premiers.<br>
donc <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">q</span>−1)*(<span style="font-style:italic">p</span>−1)</sup>=1  mod <span style="font-style:italic">n</span> et donc<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">q</span>−1)*(<span style="font-style:italic">p</span>−1)+1</sup>=<span style="font-style:italic">a</span>  mod <span style="font-style:italic">n</span> <br>
- si <span style="font-style:italic">a</span> n’est pas premier avec <span style="font-style:italic">n</span> et si <span style="font-style:italic">a</span>&lt;<span style="font-style:italic">n</span>, c’est que <span style="font-style:italic">a</span> est soit un 
multiple de <span style="font-style:italic">p</span> soit un multiple de <span style="font-style:italic">q</span> (puisque <span style="font-style:italic">a</span>&lt;<span style="font-style:italic">n</span>=<span style="font-style:italic">pq</span>).<br>
 Supposons que <span style="font-style:italic">a</span> soit un multiple de <span style="font-style:italic">p</span> :<br>
<span style="font-style:italic">a</span>=0 mod<span style="font-style:italic">p</span> donc <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)+1</sup>=<span style="font-style:italic">a</span>=0 mod<span style="font-style:italic">p</span><br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">q</span>−1</sup>=1 mod<span style="font-style:italic">q</span> car <span style="font-style:italic">q</span> est premier et <span style="font-style:italic">a</span> est premier avec <span style="font-style:italic">q</span> (th de 
Fermat), donc <br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)+1</sup>=<span style="font-style:italic">a</span> mod<span style="font-style:italic">q</span><br>
Donc <span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1)+1</sup>−<span style="font-style:italic">a</span> est un multiple de <span style="font-style:italic">p</span> et de <span style="font-style:italic">q</span> donc est un
multiple de <span style="font-style:italic">n</span>=<span style="font-style:italic">pq</span> (car <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> sont premiers).<br>

Donc si <span style="font-style:italic">n</span>=<span style="font-style:italic">p</span>*<span style="font-style:italic">q</span> avec <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> premiers quelque soit <span style="font-style:italic">a</span> et quelque soit 
<span style="font-style:italic">k</span> entier on a :<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">k</span>(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)</sup>=<span style="font-style:italic">a</span>  mod <span style="font-style:italic">n</span> .<br>

Revenons au codage.<br>
Soit <span style="font-style:italic">m</span> un nombre premier avec (<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1) (par exemple on peut choisir pour
<span style="font-style:italic">m</span> un nombre premier assez grand).<br>
D’après l’identité de Bézout il existe deux entiers <span style="font-style:italic">u</span> et <span style="font-style:italic">v</span> tels que :<br>
<span style="font-style:italic">u</span>*<span style="font-style:italic">m</span>+<span style="font-style:italic">v</span>*(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)=1<br>
 donc :<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">u</span>*<span style="font-style:italic">m</span>+<span style="font-style:italic">v</span>*(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)</sup>=<span style="font-style:italic">a</span><sup>1</sup> et comme <span style="font-style:italic">a</span><sup>(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)</sup>=1  mod <span style="font-style:italic">n</span>,<br>
<span style="font-style:italic">a</span><sup><span style="font-style:italic">u</span>*<span style="font-style:italic">m</span></sup>=<span style="font-style:italic">a</span>  mod <span style="font-style:italic">n</span><br>
La fonction <span style="font-style:italic">f</span> de codage sera alors :<br>
<span style="font-style:italic">a</span>−&gt;<span style="font-style:italic">a</span><sup><span style="font-style:italic">u</span></sup> mod<span style="font-style:italic">n</span> pour <span style="font-style:italic">a</span>&lt;<span style="font-style:italic">p</span> et <span style="font-style:italic">a</span>&lt;<span style="font-style:italic">q</span> (pour avoir pgcd(<span style="font-style:italic">a</span>,<span style="font-style:italic">n</span>)=1).<br>
La fonction <span style="font-style:italic">g</span> de décodage sera alors :<br>
<span style="font-style:italic">b</span>−&gt;<span style="font-style:italic">b</span><sup><span style="font-style:italic">m</span></sup> mod<span style="font-style:italic">n</span>.<br>
et on a bien <span style="font-style:italic">g</span>(<span style="font-style:italic">f</span>(<span style="font-style:italic">a</span>))=<span style="font-style:italic">a</span><sup><span style="font-style:italic">u</span>*<span style="font-style:italic">m</span></sup>=<span style="font-style:italic">a</span> mod<span style="font-style:italic">n</span>  ou encore <span style="font-style:italic">g</span>(<span style="font-style:italic">f</span>(<span style="font-style:italic">a</span>))=<span style="font-style:italic">a</span> car <span style="font-style:italic">a</span>&lt;<span style="font-style:italic">n</span><br>
La clé publique se trouvant dans l’annuaire sera (<span style="font-style:italic">u</span>,<span style="font-style:italic">n</span>),<br>
la clé secrète sera (<span style="font-style:italic">m</span>,<span style="font-style:italic">n</span>), mais bien sûr, <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> devront 
rester secrets.<br>
Remarque : <span style="font-style:italic">u</span> et <span style="font-style:italic">m</span> jouent un rôle symétrique, par exemple <span style="font-style:italic">u</span> est 
aussi premier avec (<span style="font-style:italic">p</span>−1)(<span style="font-style:italic">q</span>−1) et donc si on connait <span style="font-style:italic">u</span>, <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> il
sera aisé de retrouver <span style="font-style:italic">m</span> avec l’identité de Bézout (<span style="font-style:italic">u</span>*<span style="font-style:italic">m</span>+<span style="font-style:italic">v</span>*(<span style="font-style:italic">p</span>−1)*(<span style="font-style:italic">q</span>−1)=1). 
</p>
<h4 id="sec384" class="subsubsection">Troisième étape : le choix des clés</h4>
<p>
Comment vais-je choisir ma clé publique et ma clé secrète ? <br>
Si on tape :<br>
<span style="font-family:monospace">p:=nextprime(123456789)</span> (<span style="font-family:monospace">p</span> est un grand nombre premier),<br>
<span style="font-family:monospace">q:=nextprime(1234567890)</span> (<span style="font-family:monospace">q</span> est un grand nombre premier),<br>
<span style="font-family:monospace">n:=p*q</span><br>
<span style="font-family:monospace">m:=nextprime(12345678)</span> (<span style="font-family:monospace">m</span> est un nombre premier),<br>
<span style="font-family:monospace">phi:=(p-1)*(q-1)</span><br>
On vérifie que m et premier avec <span style="font-style:italic">phi</span> en tapant :<br>
<span style="font-family:monospace">gcd(m,(p-1)*(q-1))</span>, on obtient bien <span style="font-family:monospace">1</span>.<br>
On obtient :<br>
<span style="font-style:italic">p</span>=123456791, <span style="font-style:italic">q</span>= 1234567891, <span style="font-style:italic">m</span>=12345701, <span style="font-style:italic">phi</span>=152415788736473100<br>
 et on a <span style="font-style:italic">n</span>=152415790094497781 (<span style="font-style:italic">n</span> a 18 chiffres).<br>

On cherche <span style="font-style:italic">u</span> et <span style="font-style:italic">v</span> en tapant :
<span style="font-family:monospace">iegcd(m,phi)</span> (<span style="font-family:monospace">u*m+v*phi=1</span>)<br>
on obtient : [-36645934363466299,2968326,1]<br>
On tape <span style="font-family:monospace">u:=-36645934363466299+phi</span> donc <span style="font-style:italic">u</span>=115769854373006801.<br>
Donc, ma clé publique qui se trouvera dans l’annuaire sera (<span style="font-style:italic">u</span>,<span style="font-style:italic">n</span>),<br>
ma clé secrète sera (<span style="font-style:italic">m</span>,<span style="font-style:italic">n</span>) <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> devront rester secrets.
Avec ce choix de <span style="font-style:italic">p</span> et de <span style="font-style:italic">q</span>, on va choisir de découper le message en 
tranches de 3 caractères (<span style="font-style:italic">ncara</span>=3)
car 256<sup>3</sup>=16777216&lt;<span style="font-style:italic">p</span>&lt;<span style="font-style:italic">q</span> et ainsi tout nombre inférieur à 256<sup>3</sup> sera
premier avec <span style="font-style:italic">n</span>
</p>
<h4 id="sec385" class="subsubsection">Quatrième étape : le codage </h4>
<p>
Vous voulez m’envoyer le message "BABAR". Dans l’annuaire, vous trouvez en 
face de mon nom :<br>
<span style="font-style:italic">u</span>=115769854373006801 et <span style="font-style:italic">n</span>=152415790094497781<br>
Grâce à la première étape le mot "BABAR" est transformé en la liste de
nombres <span style="font-family:monospace">l=[4342082,16722]</span> car<br>
<span style="font-family:monospace">chaine2n("BAB") = 4342082 et chaine2n("AR") = 16722</span>.<br>
Vous calculez :
<span style="font-style:italic">f</span>(<span style="font-style:italic">a</span>)=<span style="font-style:italic">a</span><sup><span style="font-style:italic">u</span></sup> mod<span style="font-style:italic">n</span> grâce à la commande <span style="font-family:monospace">powmod(a,u,n)</span><br>
Vous obtenez :<br>
<span style="font-style:italic">f</span>(4342082)=4342082<sup>115769854373006801</sup>= 6243987715571440 mod <span style="font-style:italic">n</span> car<br>
 <span style="font-family:monospace">powmod(4342082,u,n) = 6243987715571440</span>.<br>
<span style="font-style:italic">f</span>(16722)=16722<sup>115769854373006801</sup>= 70206283680955159 mod <span style="font-style:italic">n</span> car<br>
<span style="font-family:monospace">powmod(16722,u,n) =70206283680955159</span>.<br>
Le message codé est donc :<br>
<span style="font-family:monospace">l=[6243987715571440,70206283680955159]</span> et c’est cette liste de
nombres que vous m’envoyez.
Remarque : On ne transforme pas cette liste de nombres en un message de 
caractères car on risque d’avoir des caractères non imprimables.<br>
Le codage transforme donc le message en une suite de nombres.
</p>
<h4 id="sec386" class="subsubsection">Cinqième étape : le décodage</h4>
<p>
Le décodage transforme une suite de nombres en un message.<br>
Je reçois <span style="font-family:monospace">l=[6243987715571440,70206283680955159]</span> pour le décoder je
calcule pour chaque élément <span style="font-style:italic">b</span> de la liste :<br>
<span style="font-style:italic">g</span>(<span style="font-style:italic">b</span>)=<span style="font-style:italic">b</span><sup><span style="font-style:italic">m</span></sup>   mod <span style="font-style:italic">n</span> grâce à la commande <span style="font-family:monospace">powmod(b,m,n)</span><br>
<span style="font-style:italic">g</span>(6243987715571440)=6243987715571440<sup><span style="font-style:italic">m</span></sup>= 4342082  mod <span style="font-style:italic">n</span> car<br>
<span style="font-family:monospace">powmod(6243987715571440,m,n)=4342082</span>.<br>
<span style="font-style:italic">g</span>(70206283680955159)=70206283680955159<sup><span style="font-style:italic">m</span></sup>= 16722  mod <span style="font-style:italic">n</span> car<br>
<span style="font-family:monospace">powmod(70206283680955159,m,n)=16722</span>.<br>
Il suffit maintenant de traduire le nombre <span style="font-style:italic">a</span>=4342082 en écrivant ce nombre 
dans la base 256 les symboles pour écrire 0&lt;<span style="font-style:italic">k</span>&lt;256 étant le caractére 
de code ASCII <span style="font-style:italic">k</span>.<br>
Je tape :<br>
<span style="font-family:monospace">irem(a,256)=66</span><br>
<span style="font-family:monospace">a:=iquo(a,256)= 16961</span><br>
puis <span style="font-family:monospace">irem(a,256)=65</span><br>
<span style="font-family:monospace">a:=iquo(a,256)=66</span><br>
<span style="font-family:monospace">irem(a,256)=66</span><br>
<span style="font-family:monospace">a:=iquo(a,256)=0</span><br>
on obtient la liste l=[66,65,66] qui correspond à "BAB"<br>
puis pour <span style="font-style:italic">a</span>=16722 <br>
Je tape :<br>
<span style="font-family:monospace">irem(a,256)=82</span><br>
<span style="font-family:monospace">a:=iquo(a,256)= 65</span><br>
puis <span style="font-family:monospace">irem(a,256)=65</span><br>
<span style="font-family:monospace">a:=iquo(a,256)=0</span><br>
on obtient la liste l=[65,82] qui correspond à "AR"
c’est ce que fait la fonction <span style="font-family:monospace">ecritu256(a)</span> (cf <a href="#sec%3Aecritu">12.12</a>), on a :<br>
 <span style="font-family:monospace">ecritu256(4342082)="BAB"</span> et <span style="font-family:monospace">ecritu256(16722)="AR"</span>
</p>
<h2 id="sec387" class="section">12.12  Les programmes correspondants au codage et décodage RSA</h2>
<p><a id="sec:ecritu"></a>
les programmes qui suivent se trouvent dans le fichier <span style="font-family:monospace">rsa.xws</span> du menu 
<span style="font-family:monospace">Exemples-&gt;arit</span>.
</p>
<h4 id="sec388" class="subsubsection">La première et la dernière étape</h4>
<pre class="verbatim">chaine2n(m):={
//chaine2n(m) transforme la chaine m en l'entier n 
//m est l'ecriture de n dans la base 256 
local l,n,s,k;
s:=size(m);
l:=asc(m);
n:=0;
for (k:=0;k&lt;s;k++){
n:=n*256+l[k];
}
return(n);
};

ecritu256(n):={
//transforme l'entier n en son ecriture en base 256
local s,r;
//n est un entier et b=256, ecritu256 est une fonction iterative 
//ecritu256(n)=le mot de caracteres l'ecriture de n en base 256 
s:="";
while (n&gt;=256){
r:=irem(n,256);
r:=char(r);
s:=r+s;
n:=iquo(n,256);
}
n:=char(n);
s:=n+s;
return(s);
};
</pre>
<h4 id="sec389" class="subsubsection">Le codage</h4>
<p>
En principe les valeurs de <span style="font-style:italic">p</span> et <span style="font-style:italic">q</span> sont beaucoup plus grandes et donc 
<span style="font-style:italic">ncara</span> le nombre de caractères par tranche peut être choisi plus grand 
que 3, il suffira alors dans le programme qui suit de d’initialiser <span style="font-family:monospace">ncara</span>
par la valeur de <span style="font-style:italic">ncara</span> que l’on a choisie (ou de rajouter le paramètre 
<span style="font-style:italic">ncara</span> et remplacer tous les 3 par <span style="font-style:italic">ncara</span>). 
</p><pre class="verbatim">//mess est une chaine u:=115769854373006801 n:=152415790094497781
codrsa(mess,u,n):={
local s,j,j3,l,mot,ncara,k,a;
s:=size(mess);
j:=0;
ncara:=3;
j3:=ncara;
l:=[];
//j est le nombre de paquets de 3 lettres
while (j3&lt;s) {
mot:="";
for (k:=j;k&lt;j3;k++){
mot:=mot+mess[k];
}
//on code le mot
a:=chaine2n(mot);
l:=append(l,powmod(a,u,n));
j:=j3;
j3:=j+ncara;
}
mot:="";
for (k:=j;k&lt;s;k++){
mot:=mot+mess[k];
}
a:=chaine2n(mot);
l:=append(l,powmod(a,u,n));
return(l);
};
</pre>
<h4 id="sec390" class="subsubsection">Le décodage</h4>
<pre class="verbatim">//l=codrsa(mess,u,n) m:=12345701 n:=152415790094497781
decodrsa(l,m,n):={
local mess,s,a,j,b;
s:=size(l);
mess:="";
for (j:=0;j&lt;s;j++){
b:=l[j];
a:=powmod(b,m,n);
mess:=mess+ecritu256(a);
}
return(mess);
};
</pre>
<h3 id="sec391" class="subsection">12.12.1  Un exemple</h3>
<p>
<span style="font-weight:bold">On envoie une liste de nombres</span><br>
On veut coder le message : "Mon chat prefere Xcas"
Avec la clé secrète u:=115769854373006801,n:=152415790094497781 et<br>
la clé publique m:=12345701,n:=152415790094497781.<br>
On tape :<br>
<span style="font-family:monospace">l:=codrsa("Mon chat prefere Xcas",u,n)</span><br>
On obtient la liste <span style="font-family:monospace">l</span> de nombres qu’on envoie :<br>
<span style="font-family:monospace">[31195019450305671,28742122827339904,95711325368572864,
31278264398990889,69628571922096941,10184568821703026,4849962211742328]</span>
Le receveur tape :<br>
<span style="font-family:monospace">decodrsa(l,m,n)</span>
et il obtient :<br>
<span style="font-family:monospace">"Mon chat prefere Xcas"</span><br>
<span style="font-weight:bold">On envoie une liste de mots</span><br>
Si on veut envoyer une liste <span style="font-family:monospace">s</span> de mots il faut transformer la liste 
<span style="font-family:monospace">l</span> en une liste de chaines de caractères 
l’aide de <span style="font-family:monospace">seq</span> (ou de <span style="font-family:monospace">$</span>) et de <span style="font-family:monospace">ecritu256</span>.<br>
On tape :<br>
<span style="font-family:monospace">s:=seq(ecritu256(l[j]),j,0,size(l)-1)</span><br>
ou <span style="font-family:monospace">s:=[ecritu256(l[j])$(j=0..size(l)-1)]</span><br>
On obtient la liste <span style="font-family:monospace">s</span> des mots qu’on envoie :<br>
Le receveur tape :<br>
<span style="font-family:monospace">decodrsa(seq(chaine2n(s[j]),j,0,size(s)-1),m,n)</span><br>
ou <span style="font-family:monospace">decodrsa([chaine2n(s[j])$(j=0..size(s)-1)],m,n)</span><br>
et il obtient :<br>
<span style="font-family:monospace">"Mon chat prefere Xcas"</span></p>
<h3 id="sec392" class="subsection">12.12.2  Exercices de décodage RSA avec différents paramètres</h3>
<p>
<span style="font-size:x-large"><br>
<br>
<br>

message 1, clefs u=115769854373006801, n=15241579009449778<br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[19997497666981017, 33496307064035264, 
72208210789185231, 38104201170888279, 
56130089351291689, 108729853375227157,
136817903768324205, 81458241359929537]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 2, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[58349203435709531, 75028631000317890,
101956612737443104, 110175082548593487,
118493016617194452,10653842382337002,
65709918090014837, 24509343625849117,
77226207180242279, 113156355216337045]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 3, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[33980482988235109, 116825916853291998,
113895924367530643, 95775057248987857,
24977608335450648, 134968149482489339,
76334436210349648, 98925075877640635,
20555288284806828]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 4, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[99352887245994702, 7452725220300033,
99097515262143188, 35018957119694836,
76149403346897851, 17052742903948315,
34401001263323402, 146933964211893603]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 5, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[69885005423074530, 71482680640174902,
76566059181695815, 136817903768324205,
34106973474155998, 33620404767752971,
12729299234654259,20531594133810598]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 6, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[58349203435709531, 68614189698168613,
95894768844660062, 130069211243087116,
130376871729616040, 74306178317514482,
125801418681172709, 128922533769427856,
138902168479749054]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 7, clefs u=115769854373006801, n=152415790094497781 
</span></p><pre class="verbatim"><span style="font-size:x-large">[82887698188763362, 147317794362550340,
11063280558757506, 62347560564639831,
66591192455199994, 108687460796034362,
68698456418704171, 113895924367530643,
97840742991040396, 103130061177405851,
21744064573167843, 81810384887704706]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 8, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[42711799087786740, 134878744490172482,
149439358926120238, 25442479184362935,
1828072730594369, 28742122827339904,
77333486723748758]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 9, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[143623866399748045, 7966012486327335,
82446555671577207, 59363718845705744,
116869540684493084, 27219079163512489,
27219079163512489, 115256914037599394,
81123177371824181, 99166826446083588,
90648282883057820, 28314425697650614,
147744966399483701, 24903506954684046]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>

message 10, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[21958089817862266, 123349109967966870,
51927845315555689, 95894768844660062,
24509343625849117, 31027419256533256,
125503703895953175, 33160330760344892,
61040361422718323, 9544287545681754,
61022858667046639]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>

message 11, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[62981976688200842, 64536302600310087,
61310840516944212, 7486629931368896,
17472057692137769, 130815067487053887,
53351663594984181, 144381092812007128,
41251258816315103, 114751369092267608]
</span></pre><p><span style="font-size:x-large"><br>
<br>
<br>
</span></p><p><span style="font-size:x-large">message 12, clefs u=115769854373006801, n=152415790094497781 <br>
</span></p><pre class="verbatim"><span style="font-size:x-large">[123477331568497546, 46498884798484169,
99097515262143188, 7837029050945492,
17052742903948315, 106657774868209674,
48690166899675267, 79883234756846796,
118493016617194452, 10653842382337002,
128514412154198539, 142579296009343477,
28886262313123302, 76149403346897851,
123466365578590711, 123115348956556877]
</span></pre>
<h3 id="sec393" class="subsection">12.12.3  Solutions des exercices de décodage</h3>
<p>
1: vous allez gagner un CD<br>
2: la solution n’est pas évidente<br>
3: vive les logiciels libres<br>
4: rien ne sert de courir<br>
5: appelons un chat un chat<br>
6: la réponse relève du défi<br>
7: habiletés calculatoires obligatoires<br>
8: il fait beau et chaud<br>
9: l’utilisation de ce codage est discutable<br>
10: nous voulons éviter la confusion<br>
11: beaucoup de travail pour rien<br>
12: science sans conscience n’est que ruine de l’ame<br>

</p>
<h2 id="sec394" class="section">12.13  Codage RSA avec signature</h2>
<p>
Avec des codages à clé publique comme RSA, n’importe qui peut vous envoyer
un message codé. La question qui se pose est : comment être sûr de
de l’identité de l’envoyeur ?<br>
Avec le codage RSA, c’est assez facile car
si Tartanpion m’envoie un message codé avec signature, il va coder et signer
le message en utilisant <span style="font-weight:bold">ma</span> clé publique et <span style="font-weight:bold">sa</span> clé sectète.<br>
Voici par exemple, les clés de codage et de décodage de Tartanpion.<br>
<span style="font-family:monospace">ptar:=nextprime(223456789)</span><br>
<span style="font-family:monospace">qtar:=nextprime(823456789)</span><br>
<span style="font-family:monospace">mtar:=nextprime(32345678)</span><br>
<span style="font-family:monospace">phitar:=(ptar-1)*(qtar-1)</span><br>
<span style="font-family:monospace">ntar:=ptar*qtar</span><br>
On obtient :<br>
<span style="font-family:monospace">ptar=223456811</span>,<br>
<span style="font-family:monospace">qtar= 823456811</span>,<br>
<span style="font-family:monospace">mtar= 32345689</span> et<br>
<span style="font-family:monospace">phitar=184007031935376100</span><br>
<span style="font-family:monospace">ntar=184007032982289721</span> (<span style="font-family:monospace">ntar</span> a 18 chiffres)<br>
et on vérifie que <span style="font-family:monospace">mtar</span> et premier avec <span style="font-family:monospace">phitar</span> en tapant :<br>
<span style="font-family:monospace">gcd(mtar,(ptar-1)*(qtar-1))</span> on obtient bien <span style="font-family:monospace">1</span>.<br>
On cherche <span style="font-family:monospace">utar</span> et <span style="font-family:monospace">vtar</span> en tapant : <span style="font-family:monospace">egcd(mtar,phitar)</span><br>
 on obtient : [-44971265178398091,7905277,1].<br>
On tape <span style="font-family:monospace">utar:=-44971265178398091+phitar</span> donc <br>
<span style="font-family:monospace">utar=139035766756978009</span>.<br>
Donc, la clé publique de Tartanpion (celle qui se trouve dans l’annuaire) 
sera <span style="font-family:monospace">(utar,ntar)</span>,<br>
sa clé secrète sera <span style="font-family:monospace">(mtar,ntar)</span> mais <span style="font-family:monospace">ptar</span> et <span style="font-family:monospace">qtar</span> devront
rester secrets.<br>
Tartanpion va coder le message <span style="font-family:monospace">mess</span> qu’il veut m’envoyer selon un 
programme analogue à <span style="font-family:monospace">codrsa(mess,u,n)</span> mais avant de mettre les nombres 
<span style="font-family:monospace">b</span> dans la liste <span style="font-family:monospace">l</span> il va utiliser sa fonction de décodage selon 
sa clé secrète et mettera dans <span style="font-family:monospace">l</span> les nombres <span style="font-family:monospace">powmod(b,mtar,ntar)</span>.<br>
Il m’envoie donc <span style="font-family:monospace">codrsas(mess,u,n,mtar,ntar)</span> (voir le programme ci-dessous).<br>
Voici le détail du programme de codage avec signature <span style="font-family:monospace">codrsas</span> (les 
programmes qui suivent se trouvent dans le fichier <span style="font-family:monospace">rsas</span>) :
</p><pre class="verbatim">//mess=chaine 
//u:=115769854373006801 n:=152415790094497781 (ma cle publique)
//ntar:=184007032982289721 et mtar:=32345689 (cle secrete de Tar)
codrsas(mess,u,n,mtar,ntar):={
local s,j,j3,l,mot,a,b,ncara;
s:=size(mess);
j:=0;
ncara:=3
j3:=ncara;
l:=[];
//j est l'indice du premier \'el\'ement d'un paquet de 3 lettres
while (j3&lt;=s) {
mot:="";
for (k:=j;k&lt;j3;k++){
mot:=mot+mess[k];
}
//on code le mot
a:=chaine2n(mot);
b:=powmod(a,u,n); 
//fct de codage selon la cle publique (u,n) du receveur puis
//fct de decodage selon la cle secrete de l'envoyeur (mtar,ntar)
l:=append(l,powmod(b,mtar,ntar));
j:=j3;
j3:=j+ncara;
}
//on code la derniere tranche du message
mot:="";
for (k:=j;k&lt;s;k++){
mot:=mot+mess[k];
}
a:=chaine2n(mot);
b:=powmod(a,u,n);
l:=append(l,powmod(b,mtar,ntar));
return(l);
};
</pre><p>
Pour décoder il me suffira de coder les nombres <span style="font-family:monospace">b</span> de la liste <span style="font-family:monospace">l</span> 
en utilisant la clé publique de celui qui a signé le message 
(<span style="font-family:monospace">a:=powmod(b,utar,ntar)</span>) puis, de décoder <span style="font-family:monospace">a</span> en utilisant ma 
clé secréte (<span style="font-family:monospace">b:=powmod(a,u,n)</span>). 
</p><pre class="verbatim">//l=codrsas(mess,u,n,mtar,ntar)
// m:=12345701 n:=152415790094497781 ma cle secrete (receveur)
//ntar:=184007032982289721 utar:=139035766756978009 cle pub de T 
decodrsas(l,m,n,utar,ntar):={
local mess,s,a,j,b;
s:=size(l);
mess:="";
for (j:=0;j&lt;s;j++){
b:=l[j];
//codage selon la cle publique (utar,ntar) de l'envoyeur (T)
a:=powmod(b,utar,ntar);
//decodage selon la cle secrete du receveur (m,n) (moi)
b:=powmod(a,m,n);
mess:=mess+ecritu256(b);
}
return(mess);
};
</pre><p>
Je reçois un message <span style="font-family:monospace">l</span> signé de Tartanpion : je le décode en 
utilisant sa clé publique et ma clé secrète en tapant :<br>
<span style="font-family:monospace">decodrsas(l,m,n,utar,ntar)</span><br>
Voici le détail avec <span style="font-family:monospace">mess:="demain 10 heures gare de Grenoble"</span>.<br>
<span style="font-family:monospace">l:=codrsas(mess,u,n,mtar,ntar)</span><br>
<span style="font-family:monospace">l:= [137370234628529043,113626149789068692,125222577739438308,<br>
33473651820936779,42708525589347295,23751805405519257,<br>
66289870504591745]</span><br>
<span style="font-family:monospace">decodrsas(l,m,n,utar,ntar)="demain 10 heures gare de Grenoble"</span>
</p>
<h3 id="sec395" class="subsection">12.13.1  Quelques précautions</h3>
<p>
Lorsqu’on envoie un message, il ne faut utiliser que les caractères dont les 
codes ASCII vont de 32 à 127. Il faut par exemple se méfier des 
caractères accentués qui n’ont pas toujours le même code...
Pour un codage avec signature on a des problèmes si on tape:<br>
<span style="font-family:monospace">messcs:=decodrsa(codrsa(mess,u,n),mtar,ntar)</span> car alors dans <span style="font-family:monospace">messcs</span>
il figure très certainement des caractères qui ont des codes inférieurs
à 32 ou des codes supérieurs à 127.<br>
Pour mémoire :<br>
<span style="font-family:monospace">decodrsa(codrsa(mess,u,n),m,n)=mess</span> car <span style="font-family:monospace">mess</span> n’a que des 
caractères qui on des codes compris entre 32 et 127.</p>
<hr>
<a href="casrouge011.html"><img src="previous_motif.gif" alt="Previous"></a>
<a href="index.html"><img src="contents_motif.gif" alt="Up"></a>
<a href="casrouge013.html"><img src="next_motif.gif" alt="Next"></a>
</body>
</html>
